<!-- ZenLife 2.0 å•†åŸé¡µ - ç»ç’ƒæ‹Ÿæ€é¡¶éƒ¨ -->
<view class="mall-header-wrap">
	<view class="mall-header">
		<view class="header-left">
			<view class="header-title">å•†åŸ</view>
		</view>
		<view class="header-actions">
			<view class="action-btn {{viewMode!=='grid'?'':'active'}}" bindtap="toggleViewMode">
				<text class="btn-icon">{{viewMode==='grid' ? 'â˜°' : 'âŠ'}}</text>
			</view>
			<view class="action-btn" bindtap="openFilter">
				<text class="btn-icon">â–½</text>
			</view>
		</view>
	</view>

	<!-- æœç´¢æ¡† - ç»ç’ƒå†…é˜´å½±æ•ˆæœ -->
	<view class="search-bar">
		<text class="search-icon">ğŸ”</text>
		<input class="search-input" placeholder="æœç´¢æ²™å‘ã€æ¡Œæ¤…..." value="{{searchText}}" bindinput="onSearchInput" confirm-type="search" bindconfirm="onSearchConfirm" />
	</view>

	<!-- ç­›é€‰æ ‡ç­¾ -->
	<view class="filter-tabs">
		<view class="tab-item {{sortKey==='comprehensive'?'active':''}}" data-key="comprehensive" bindtap="onTapSort">
			<text>ç»¼åˆ</text>
			<view class="tab-indicator" wx:if="{{sortKey==='comprehensive'}}"></view>
		</view>
		<view class="tab-item {{sortKey==='sales'?'active':''}}" data-key="sales" bindtap="onTapSort">
			<text>é”€é‡</text>
			<view class="tab-indicator" wx:if="{{sortKey==='sales'}}"></view>
		</view>
		<view class="tab-item {{sortKey==='price'?'active':''}}" data-key="price" bindtap="onTapPrice">
			<text>ä»·æ ¼</text>
			<view class="tab-indicator" wx:if="{{sortKey==='price'}}"></view>
		</view>
		<view class="tab-item" bindtap="openCategory">
			<text>ç±»åˆ«</text>
		</view>
		<view class="tab-item {{showStylePopup?'active':''}}" bindtap="toggleStyle">
			<text>é£æ ¼</text>
		</view>
	</view>
</view>

<view class="page">

	<!-- é£æ ¼å¼¹çª— -->
	<view class="style-popup" wx:if="{{showStylePopup}}">
		<view class="style-list">
			<block wx:for="{{styles}}" wx:key="*this">
				<view class="style-tag {{selectedStyle===item?'active':''}}" data-style="{{item}}" bindtap="onSelectStyle">{{item}}</view>
			</block>
		</view>
		<view class="style-actions">
			<button class="btn-reset" bindtap="resetStyle">é‡ç½®</button>
			<button class="btn-apply" bindtap="applyStyle">ç¡®å®š</button>
		</view>
	</view>

	<!-- ç±»åˆ«æŠ½å±‰é®ç½© -->
	<view class="drawer-mask {{showCategoryDrawer?'active':''}}" wx:if="{{showCategoryDrawer}}" bindtap="closeCategory"></view>
	<!-- å·¦ä¾§ç±»åˆ«æŠ½å±‰ -->
	<view class="drawer" wx:if="{{showCategoryDrawer}}">
		<scroll-view scroll-y class="drawer-list">
			<block wx:for="{{categories}}" wx:key="id">
				<view class="drawer-item {{selectedCategory===item.id?'active':''}}" data-id="{{item.id}}" data-name="{{item.name}}" bindtap="onSelectCategory">{{item.name}}</view>
			</block>
		</scroll-view>
	</view>

	<!-- å•†å“åˆ—è¡¨ - ç½‘æ ¼æ¨¡å¼ -->
	<scroll-view scroll-y class="goods-scroll" wx:if="{{viewMode==='grid'}}">
		<view class="goods-grid">
			<block wx:for="{{filteredGoods}}" wx:key="id">
				<view class="goods-card" bindtap="goDetail" data-id="{{item.id}}">
					<!-- å›¾ç‰‡åŒºåŸŸ - å¸¦æ”¶è—æŒ‰é’® -->
					<view class="card-image-wrap">
						<image class="card-image" src="{{item.thumb || item.cover || item.image || item.pic}}" mode="aspectFill"></image>
						<view class="card-fav-btn" catchtap="toggleFav" data-id="{{item.id}}">
							<text>â™¡</text>
						</view>
					</view>
					<!-- ä¿¡æ¯åŒºåŸŸ -->
					<view class="card-info">
						<view class="card-name">{{item.name}}</view>
						<view class="card-desc">{{item.subtitle || item.category || ''}}</view>
						<view class="card-bottom">
							<view class="card-price">Â¥ {{item.price}}</view>
							<view class="card-cart-btn" catchtap="addToCart" data-id="{{item.id}}">
								<text>ğŸ›’</text>
							</view>
						</view>
					</view>
				</view>
			</block>
		</view>
		<view style="height: 200rpx;"></view>
	</scroll-view>

	<!-- å•†å“åˆ—è¡¨ - å¤§å›¾æ¨¡å¼ -->
	<scroll-view scroll-y class="goods-scroll" wx:else>
		<view class="goods-list-large">
			<block wx:for="{{filteredGoods}}" wx:key="id">
				<view class="goods-card-large" bindtap="goDetail" data-id="{{item.id}}">
					<!-- æœ‰æœºblobèƒŒæ™¯ -->
					<view class="card-blob blob-1"></view>
					<view class="card-blob blob-2"></view>
					
					<!-- å¤´éƒ¨ -->
					<view class="card-header">
						<view class="card-header-text">
							<view class="card-title">{{item.name}}</view>
							<view class="card-subtitle">{{item.subtitle || item.material || ''}}</view>
						</view>
						<view class="card-fav-btn-large" catchtap="toggleFav" data-id="{{item.id}}">
							<text>â™¡</text>
						</view>
					</view>
					
					<!-- å›¾ç‰‡ -->
					<view class="card-image-large">
						<image src="{{item.thumb || item.cover || item.image || item.pic}}" mode="aspectFit"></image>
					</view>
					
					<!-- åº•éƒ¨ä»·æ ¼æ  -->
					<view class="card-footer">
						<view class="footer-left">
							<view class="price-label">PRICE</view>
							<view class="price-value">Â¥ {{item.price}}</view>
						</view>
						<view class="footer-btn" catchtap="addToCart" data-id="{{item.id}}">
							<view class="btn-icon-wrap">ğŸ›’</view>
							<text>åŠ å…¥è´­ç‰©è½¦</text>
						</view>
					</view>
				</view>
			</block>
		</view>
		<view style="height: 200rpx;"></view>
	</scroll-view>
</view>


