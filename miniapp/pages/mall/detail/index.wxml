<!-- å•†å“è¯¦æƒ…é¡µ - ZenLife 2.0 è®¾è®¡ -->
<view class="detail-page">
	<!-- é¡¶éƒ¨å¯¼èˆªæ  -->
	<view class="detail-header">
		<view class="header-left" bindtap="onBack">
			<text class="back-icon">â†</text>
		</view>
		<view class="header-center">
			<text class="header-title">{{goods.name}}</text>
		</view>
		<view class="header-right">
			<view class="header-btn" bindtap="onFav">
				<text class="header-icon {{isFavorited ? 'favorited' : ''}}">{{isFavorited ? 'â™¥' : 'â™¡'}}</text>
			</view>
			<view class="header-btn">
				<text class="header-icon">â‹¯</text>
			</view>
		</view>
	</view>

	<!-- ä¸»å†…å®¹åŒº -->
	<view class="detail-content">
		<!-- å•†å“å¤§å›¾åŒº -->
		<view class="product-hero">
			<!-- å·¦ä¾§å°ºå¯¸æŒ‰é’® -->
			<view class="dimension-sidebar">
				<view class="dim-btn" bindtap="showSpecsSheet">
					<text class="dim-icon">â†•</text>
					<text class="dim-label">é«˜</text>
				</view>
				<view class="dim-btn" bindtap="showSpecsSheet">
					<text class="dim-icon">â†”</text>
					<text class="dim-label">å®½</text>
				</view>
				<view class="dim-btn" bindtap="showSpecsSheet">
					<text class="dim-icon">â¬œ</text>
					<text class="dim-label">é•¿</text>
				</view>
				<view class="dim-btn specs-btn" bindtap="showSpecsSheet">
					<text class="specs-label">é€‰è§„æ ¼</text>
				</view>
			</view>

			<!-- å•†å“å›¾ç‰‡ -->
			<swiper class="hero-swiper" autoplay circular interval="4000" current="{{imageIndex}}" bindchange="onSwiperChange">
				<swiper-item wx:for="{{images}}" wx:key="*this">
					<image class="hero-img" src="{{item}}" mode="aspectFit" data-src="{{item}}" bindtap="onPreview"></image>
				</swiper-item>
			</swiper>

			<!-- å³ä¸‹è§’è´­ç‰©è½¦æ‚¬æµ®æŒ‰é’® -->
			<view class="float-cart" bindtap="goCart">
				<view class="float-cart-icon">ğŸ›’</view>
				<view class="float-cart-badge" wx:if="{{cartCount > 0}}">{{cartCount > 99 ? '99+' : cartCount}}</view>
			</view>
		</view>

		<!-- åº•éƒ¨ç™½è‰²å¡ç‰‡ -->
		<view class="bottom-card">
			<!-- é¢œè‰²é€‰æ‹©å™¨ -->
			<view class="color-picker" wx:if="{{colors.length > 0 || materialsGroups.length > 0}}">
				<block wx:for="{{displayColors}}" wx:key="index">
					<view 
						class="color-item {{selectedColorIndex === index ? 'active' : ''}}" 
						style="background-color: {{item.hex || '#DEB887'}}"
						data-index="{{index}}"
						bindtap="onSelectColor"
					></view>
				</block>
				<view class="color-more" bindtap="showColorSheet">
					<text>+</text>
				</view>
			</view>

			<!-- å•†å“åç§°å’Œæ•°é‡ -->
			<view class="product-title-row">
				<view class="product-name">{{goods.name}}</view>
				<view class="quantity-stepper">
					<view class="stepper-btn" bindtap="decreaseQty">âˆ’</view>
					<text class="stepper-value">{{quantity < 10 ? '0' + quantity : quantity}}</text>
					<view class="stepper-btn" bindtap="increaseQty">+</view>
				</view>
			</view>

			<!-- å·²é€‰é…ç½® -->
			<view class="selected-config">
				<text class="config-label">å·²é€‰é…ç½®</text>
				<view class="config-value" bindtap="showSpecsSheet">
					<text>{{selectedConfigText}}</text>
					<text class="config-arrow">é€‰å®šé¢œè‰²</text>
				</view>
			</view>

			<!-- ä»·æ ¼å’ŒåŠ å…¥è´­ç‰©è½¦ -->
			<view class="price-action-row">
				<view class="price-info">
					<text class="price-value">Â¥{{totalPrice}}</text>
					<text class="price-label">Total Payable</text>
				</view>
				<view class="add-cart-btn" bindtap="onAddCart">
					<text class="cart-icon">ğŸ›’</text>
					<text>åŠ å…¥è´­ç‰©è½¦</text>
				</view>
			</view>
		</view>
	</view>
</view>

<!-- è§„æ ¼é€‰æ‹©å¼¹çª— -->
<view class="sheet-mask {{showSpecs ? 'show' : ''}}" bindtap="hideSpecsSheet"></view>
<view class="spec-sheet {{showSpecs ? 'show' : ''}}">
	<view class="sheet-handle"></view>
	<view class="sheet-title">è§„æ ¼ (å«å›¾ç‰‡)</view>
	<scroll-view class="spec-list" scroll-y>
		<view class="spec-grid">
			<block wx:for="{{sizes}}" wx:key="name">
				<view class="spec-card {{sizeIndex === index ? 'active' : ''}}" data-index="{{index}}" bindtap="onSelectSize">
					<image class="spec-card-img" src="{{item.img}}" mode="aspectFill"></image>
					<view class="spec-card-check" wx:if="{{sizeIndex === index}}">âœ“</view>
					<view class="spec-card-name">{{item.name}}</view>
					<view class="spec-card-dims">{{item.dims}}</view>
				</view>
			</block>
		</view>
	</scroll-view>
	<view class="sheet-confirm" bindtap="hideSpecsSheet">ç¡®è®¤é…ç½®</view>
</view>

<!-- æè´¨é¢œè‰²é€‰æ‹©å¼¹çª— -->
<view class="sheet-mask {{showColors ? 'show' : ''}}" bindtap="hideColorSheet"></view>
<view class="color-sheet {{showColors ? 'show' : ''}}">
	<view class="sheet-handle"></view>
	<view class="sheet-header">
		<text class="sheet-title">æ‰€æœ‰æè´¨ä¸é¢œè‰²</text>
		<view class="sheet-close" bindtap="hideColorSheet">âœ•</view>
	</view>
	<scroll-view class="color-scroll" scroll-y>
		<block wx:for="{{materialsGroups}}" wx:key="name" wx:for-index="gi">
			<view class="material-group">
				<view class="material-group-title">
					<view class="material-indicator"></view>
					<text>{{item.name}}</text>
				</view>
				<view class="color-grid">
					<block wx:for="{{item.colors}}" wx:key="name" wx:for-index="ci">
						<view 
							class="color-option {{materialGroupIndex === gi && materialColorIndex === ci ? 'active' : ''}}" 
							data-g="{{gi}}" 
							data-c="{{ci}}" 
							bindtap="onSelectMaterialColor"
						>
							<view class="color-swatch" style="background-color: {{item.hex || '#DEB887'}}"></view>
							<text class="color-name">{{item.name || ('è‰²å·' + (ci + 1))}}</text>
						</view>
					</block>
				</view>
			</view>
		</block>
	</scroll-view>
	<view class="sheet-confirm" bindtap="hideColorSheet">ç¡®è®¤é€‰æ‹©</view>
</view>


