<!-- 订单详情页 — Apple 风格 -->
<navigation-bar title="订单详情" back="{{true}}" color="black" background="#FFFFFF"></navigation-bar>
<view class="page">
  <scroll-view class="scroll-area" scroll-y enhanced show-scrollbar="{{false}}">
    <!-- 订单状态 -->
    <view class="status-card">
      <view class="status-icon">{{statusIcon}}</view>
      <view class="status-info">
        <view class="status-text">{{statusText}}</view>
        <view class="status-hint" wx:if="{{statusHint}}">{{statusHint}}</view>
      </view>
    </view>

    <!-- 收货地址 -->
    <view class="section-card" wx:if="{{order.address}}">
      <view class="section-label">收货信息</view>
      <view class="address-row">
        <text class="addr-name">{{order.address.name}}</text>
        <text class="addr-phone">{{order.address.phone}}</text>
      </view>
      <view class="addr-detail">{{order.address.province}}{{order.address.city}}{{order.address.district}}{{order.address.address}}</view>
    </view>

    <!-- 商品列表 -->
    <view class="section-card">
      <view class="section-label">商品信息</view>
      <block wx:for="{{order.items}}" wx:key="id">
        <view class="goods-item" bindtap="goProductDetail" data-id="{{item.goodsId || item.id}}">
          <image class="goods-thumb" src="{{item.thumb || item.image}}" mode="aspectFill"></image>
          <view class="goods-info">
            <view class="goods-name text-ellipsis">{{item.name}}</view>
            <view class="goods-specs" wx:if="{{item.specs}}">
              <text wx:if="{{item.specs.size}}">{{item.specs.size}}</text>
              <text wx:if="{{item.specs.material}}"> · {{item.specs.material}}</text>
            </view>
            <view class="goods-bottom">
              <text class="goods-price">¥{{item.price}}</text>
              <text class="goods-qty">×{{item.quantity || item.count || 1}}</text>
            </view>
          </view>
        </view>
      </block>
    </view>

    <!-- 价格明细 -->
    <view class="section-card">
      <view class="section-label">价格明细</view>
      <view class="price-row">
        <text>商品金额</text>
        <text>¥{{order.goodsTotal || order.totalAmount}}</text>
      </view>
      <view class="price-row" wx:if="{{order.couponDiscount}}">
        <text>优惠券</text>
        <text class="discount">-¥{{order.couponDiscount}}</text>
      </view>
      <view class="price-row">
        <text>运费</text>
        <text>{{order.freight > 0 ? '¥' + order.freight : '免运费'}}</text>
      </view>
      <view class="price-total">
        <text>实付款</text>
        <text class="total-value"><text class="symbol">¥</text>{{order.totalAmount}}</text>
      </view>
    </view>

    <!-- 订单信息 -->
    <view class="section-card">
      <view class="section-label">订单信息</view>
      <view class="info-row">
        <text class="info-label">订单编号</text>
        <text class="info-value" bindtap="copyOrderNo">{{order.orderNumber || order._id}} 复制</text>
      </view>
      <view class="info-row">
        <text class="info-label">下单时间</text>
        <text class="info-value">{{order.createTime}}</text>
      </view>
      <view class="info-row" wx:if="{{order.remark}}">
        <text class="info-label">备注</text>
        <text class="info-value">{{order.remark}}</text>
      </view>
    </view>

    <view style="height: 200rpx;"></view>
  </scroll-view>

  <!-- 底部操作 -->
  <view class="bottom-bar" wx:if="{{showActions}}">
    <view class="action-btn secondary" wx:if="{{order.status === 'pending'}}" bindtap="cancelOrder">取消订单</view>
    <view class="action-btn primary" wx:if="{{order.status === 'pending'}}" bindtap="payOrder">去支付</view>
    <view class="action-btn primary" wx:if="{{order.status === 'shipped'}}" bindtap="confirmReceive">确认收货</view>
    <view class="action-btn secondary" wx:if="{{order.status === 'completed'}}" bindtap="goRefund">申请售后</view>
    <view class="action-btn primary" bindtap="contactService">联系客服</view>
  </view>
</view>