<!-- è®¢å•ç¡®è®¤é¡µ â€” Apple é£æ ¼ -->
<navigation-bar title="ç¡®è®¤è®¢å•" back="{{true}}" color="black" background="#FFFFFF"></navigation-bar>
<view class="page">
  <scroll-view class="scroll-area" scroll-y enhanced show-scrollbar="{{false}}">
    <!-- æ”¶è´§åœ°å€ -->
    <view class="address-card" bindtap="goSelectAddress">
      <view class="address-content" wx:if="{{selectedAddress}}">
        <view class="address-top">
          <text class="address-name">{{selectedAddress.name}}</text>
          <text class="address-phone">{{selectedAddress.phone}}</text>
        </view>
        <view class="address-detail">{{selectedAddress.province}}{{selectedAddress.city}}{{selectedAddress.district}}{{selectedAddress.address}}</view>
      </view>
      <view class="address-empty" wx:else>
        <text class="address-empty-icon">ğŸ“</text>
        <text class="address-empty-text">è¯·é€‰æ‹©æ”¶è´§åœ°å€</text>
      </view>
      <text class="address-arrow">â€º</text>
    </view>

    <!-- å•†å“åˆ—è¡¨ -->
    <view class="goods-card">
      <view class="goods-header">
        <text class="goods-header-title">å•†å“ä¿¡æ¯</text>
        <text class="goods-header-count">å…± {{items.length}} ä»¶</text>
      </view>
      <block wx:for="{{items}}" wx:key="id">
        <view class="goods-item">
          <image class="goods-thumb" src="{{item.thumb || item.image || item.goodsImage}}" mode="aspectFill"></image>
          <view class="goods-info">
            <view class="goods-name text-ellipsis">{{item.name || item.goodsName}}</view>
            <view class="goods-specs" wx:if="{{item.sizeName || item.materialName}}">
              <text wx:if="{{item.sizeName}}">{{item.sizeName}}</text>
              <text wx:if="{{item.materialName}}"> Â· {{item.materialName}}</text>
              <text wx:if="{{item.materialColor}}"> {{item.materialColor}}</text>
            </view>
            <view class="goods-price-row">
              <text class="goods-price">Â¥{{item.price || item.totalPrice}}</text>
              <text class="goods-qty">Ã—{{item.count || 1}}</text>
            </view>
          </view>
        </view>
      </block>
    </view>

    <!-- ä¼˜æƒ åˆ¸ -->
    <view class="option-card" bindtap="goSelectCoupon">
      <text class="option-label">ä¼˜æƒ åˆ¸</text>
      <view class="option-right">
        <text class="option-value {{selectedCoupon ? 'has-value' : ''}}">{{selectedCoupon ? '-Â¥' + selectedCoupon.discount : 'æš‚æ— å¯ç”¨'}}</text>
        <text class="option-arrow">â€º</text>
      </view>
    </view>

    <!-- å¤‡æ³¨ -->
    <view class="option-card">
      <text class="option-label">è®¢å•å¤‡æ³¨</text>
      <input class="option-input" placeholder="é€‰å¡«" value="{{remark}}" bindinput="onRemarkInput" />
    </view>

    <!-- ä»·æ ¼æ˜ç»† -->
    <view class="price-card">
      <view class="price-row">
        <text class="price-label">å•†å“é‡‘é¢</text>
        <text class="price-value">Â¥{{goodsTotal}}</text>
      </view>
      <view class="price-row" wx:if="{{couponDiscount > 0}}">
        <text class="price-label">ä¼˜æƒ åˆ¸</text>
        <text class="price-value discount">-Â¥{{couponDiscount}}</text>
      </view>
      <view class="price-row">
        <text class="price-label">è¿è´¹</text>
        <text class="price-value">{{freight > 0 ? 'Â¥' + freight : 'å…è¿è´¹'}}</text>
      </view>
      <view class="price-total-row">
        <text class="price-total-label">åˆè®¡</text>
        <text class="price-total-value"><text class="price-symbol">Â¥</text>{{totalAmount}}</text>
      </view>
    </view>

    <view style="height: 200rpx;"></view>
  </scroll-view>

  <!-- åº•éƒ¨æäº¤æ  -->
  <view class="bottom-bar">
    <view class="bar-info">
      <text class="bar-label">å®ä»˜æ¬¾</text>
      <text class="bar-amount"><text class="bar-symbol">Â¥</text>{{totalAmount}}</text>
    </view>
    <view class="bar-btn" bindtap="submitOrder">
      <text>æäº¤è®¢å•</text>
    </view>
  </view>
</view>