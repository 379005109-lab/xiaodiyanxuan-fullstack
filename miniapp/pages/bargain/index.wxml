<navigation-bar title="" back="{{false}}" color="black" background="transparent"></navigation-bar>
<scroll-view class="scrollarea" scroll-y>
	<view class="page">
		<!-- 页面标题栏 -->
		<view class="page-header">
			<view class="page-title">砍价专区</view>
			<view class="my-bargain-link" bindtap="goMyBargain">我的砍价</view>
		</view>

		<!-- 商品列表 -->
		<view class="product-list">
			<view class="product-card" wx:for="{{goodsList}}" wx:key="id" data-id="{{item.id}}" bindtap="onStartBargain">
				<!-- 左侧图片区 -->
				<view class="product-image-wrap">
					<image class="product-image" src="{{item.cover}}" mode="aspectFill"></image>
					<view class="image-gradient"></view>
					<view class="helper-badge">
						<view class="helper-dot"></view>
						<text class="helper-count">{{item.cutCount || 0}}人助力</text>
					</view>
				</view>
				<!-- 右侧信息区 -->
				<view class="product-info">
					<view class="product-name">{{item.name}}</view>
					<view class="product-desc">{{item.desc || '高品质家具，源头好货，砍价更优惠...'}}</view>
					<view class="price-action">
						<view class="price-row">
							<text class="price-origin">¥{{item.origin}}</text>
							<text class="price-current">¥{{item.price}}</text>
						</view>
						<button class="btn-cut" catchtap="onStartBargain" data-id="{{item.id}}">砍一刀</button>
					</view>
				</view>
			</view>
		</view>

		<view class="my-bargain" wx:if="{{myBargains.length > 0}}">
			<view class="section-title-new">我的砍价</view>
			<block wx:for="{{myBargains}}" wx:key="id">
				<view class="my-bargain-card" data-id="{{item.id}}" bindtap="onViewMyBargain">
					<view class="my-bargain-row">
						<image class="my-bargain-img" src="{{item.cover}}" mode="aspectFill"></image>
						<view class="my-bargain-info">
							<view class="my-bargain-header">
								<text class="my-bargain-name">{{item.name}}</text>
								<text class="my-bargain-status">进行中</text>
							</view>
							<view class="my-bargain-prices">
								<text class="my-bargain-target">目标价 ¥{{item.price}}</text>
								<text class="my-bargain-origin">原价 ¥{{item.origin}}</text>
							</view>
							<view class="my-bargain-progress-wrap">
								<view class="my-bargain-progress-bar">
									<view class="my-bargain-progress-fill" style="width: {{Math.min(100, Math.round(item.progress * 100))}}%;"></view>
								</view>
								<text class="my-bargain-remain">还差 ¥{{item.remain}}</text>
							</view>
						</view>
					</view>
					<view class="my-bargain-btns">
						<button class="my-bargain-btn invite" open-type="share" data-id="{{item.id}}">邀请好友助力</button>
						<button class="my-bargain-btn cancel" bindtap="onCancelMyBargain" data-id="{{item.id}}" catchtap="">取消</button>
					</view>
				</view>
			</block>
		</view>

		<view class="rules">
			<view class="rule-header">规则说明</view>
			<view class="rule-body">
				<text>每人每日可砍 3 次；砍价有效期 24 小时；满足条件可提现。</text>
			</view>
		</view>
	</view>
</scroll-view>


