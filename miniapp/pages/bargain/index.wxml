<navigation-bar title="" back="{{false}}" color="black" background="transparent"></navigation-bar>
<scroll-view class="scrollarea" scroll-y>
	<view class="page">
		<!-- 顶部活动Banner -->
		<view class="bargain-banner">
			<view class="banner-bg"></view>
			<view class="banner-content">
				<view class="banner-title">砍价专区</view>
				<view class="banner-subtitle">邀请好友助力，最高省50%</view>
			</view>
			<view class="banner-action" bindtap="goMyBargain">
				<text>我的砍价</text>
				<text class="arrow">›</text>
			</view>
		</view>

		<!-- 商品列表 -->
		<view class="section-header">
			<text class="section-title">热门砍价</text>
			<text class="section-desc">{{goodsList.length}}件商品参与中</text>
		</view>
		<view class="product-grid">
			<view class="product-card-new" wx:for="{{goodsList}}" wx:key="id" data-id="{{item.id}}" bindtap="onStartBargain">
				<view class="product-image-box">
					<image class="product-img" src="{{item.cover}}" mode="aspectFill"></image>
					<view class="discount-tag">-{{item.discountPercent || 30}}%</view>
				</view>
				<view class="product-detail">
					<view class="product-name-new">{{item.name || '限时特惠商品'}}</view>
					<view class="product-prices">
						<text class="current-price">¥{{item.price}}</text>
						<text class="origin-price">¥{{item.origin}}</text>
					</view>
					<view class="product-meta">
						<view class="helper-info">
							<view class="helper-dot-new"></view>
							<text>{{item.cutCount || 0}}人已助力</text>
						</view>
						<button class="cut-btn" catchtap="onStartBargain" data-id="{{item.id}}">砍一刀</button>
					</view>
				</view>
			</view>
		</view>

		<view class="my-bargain" wx:if="{{myBargains.length > 0}}">
			<view class="section-title-new">我的砍价</view>
			<block wx:for="{{myBargains}}" wx:key="id">
				<view class="my-bargain-card" data-id="{{item.id}}" bindtap="onViewMyBargain">
					<view class="my-bargain-row">
						<image class="my-bargain-img" src="{{item.cover}}" mode="aspectFill"></image>
						<view class="my-bargain-info">
							<view class="my-bargain-header">
								<text class="my-bargain-name">{{item.name}}</text>
								<text class="my-bargain-status">进行中</text>
							</view>
							<view class="my-bargain-prices">
								<text class="my-bargain-target">目标价 ¥{{item.price}}</text>
								<text class="my-bargain-origin">原价 ¥{{item.origin}}</text>
							</view>
							<view class="my-bargain-progress-wrap">
								<view class="my-bargain-progress-bar">
									<view class="my-bargain-progress-fill" style="width: {{Math.min(100, Math.round(item.progress * 100))}}%;"></view>
								</view>
								<text class="my-bargain-remain">还差 ¥{{item.remain}}</text>
							</view>
						</view>
					</view>
					<view class="my-bargain-btns">
						<button class="my-bargain-btn invite" open-type="share" data-id="{{item.id}}">邀请好友助力</button>
						<button class="my-bargain-btn cancel" catchtap="onCancelMyBargain" data-id="{{item.id}}">取消</button>
					</view>
				</view>
			</block>
		</view>

		<view class="rules">
			<view class="rule-header">规则说明</view>
			<view class="rule-body">
				<text>每人每日可砍 3 次；砍价有效期 24 小时；满足条件可提现。</text>
			</view>
		</view>
	</view>
</scroll-view>


