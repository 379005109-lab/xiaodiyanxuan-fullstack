<navigation-bar title="è´­ç‰©è½¦" back="{{true}}" color="black" background="#FFF"></navigation-bar>
<scroll-view class="scrollarea" scroll-y enhanced show-scrollbar="{{false}}">
  <view class="page">

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{cartList.length === 0}}">
      <text class="empty-icon">ğŸ›’</text>
      <text class="empty-title">è´­ç‰©è½¦æ˜¯ç©ºçš„</text>
      <text class="empty-desc">å¿«å»æŒ‘é€‰å¿ƒä»ªçš„å•†å“å§</text>
      <button class="empty-btn" bindtap="goMall">å»é€›é€›</button>
    </view>

    <!-- å…¨é€‰æ  -->
    <view class="select-bar" wx:if="{{cartList.length > 0}}">
      <view class="select-left" bindtap="onToggleAll">
        <view class="checkbox {{allChecked ? 'checked' : ''}}">
          <text wx:if="{{allChecked}}">âœ“</text>
        </view>
        <text class="select-text">å…¨é€‰</text>
      </view>
      <text class="select-count">å·²é€‰ {{checkedCount}} ä»¶</text>
    </view>

    <!-- è´­ç‰©è½¦åˆ—è¡¨ -->
    <view class="cart-list" wx:if="{{cartList.length > 0}}">
      <view class="cart-card" wx:for="{{cartList}}" wx:key="id">
        <view class="cart-row">
          <!-- å¤é€‰æ¡† -->
          <view class="checkbox {{item.checked ? 'checked' : ''}}" bindtap="onToggleCheck" data-index="{{index}}">
            <text wx:if="{{item.checked}}">âœ“</text>
          </view>
          <!-- å•†å“å›¾ç‰‡ -->
          <image class="cart-thumb" src="{{item.thumb}}" mode="aspectFill" bindtap="goDetail" data-id="{{item.id}}"></image>
          <!-- å•†å“ä¿¡æ¯ -->
          <view class="cart-info">
            <view class="cart-name text-ellipsis">{{item.name}}</view>
            <view class="cart-specs">
              <text class="cart-spec" wx:if="{{item.sizeName}}">{{item.sizeName}}</text>
              <text class="cart-spec" wx:if="{{item.fabric || item.material}}">{{item.fabric || item.material}}</text>
              <text class="cart-spec" wx:if="{{item.materialColor}}">{{item.materialColor}}</text>
            </view>
            <view class="cart-bottom">
              <text class="cart-price"><text class="price-symbol">Â¥</text>{{item.price}}</text>
              <view class="qty-control">
                <view class="qty-btn" bindtap="onDecrease" data-index="{{index}}">âˆ’</view>
                <text class="qty-value">{{item.count || 1}}</text>
                <view class="qty-btn" bindtap="onIncrease" data-index="{{index}}">+</view>
              </view>
            </view>
          </view>
        </view>
        <!-- æ»‘åŠ¨åˆ é™¤æŒ‰é’® -->
        <view class="cart-delete" catchtap="onDelete" data-index="{{index}}">
          <text>åˆ é™¤</text>
        </view>
      </view>
    </view>

    <!-- åº•éƒ¨å ä½ -->
    <view style="height: 180rpx;" wx:if="{{cartList.length > 0}}"></view>
  </view>
</scroll-view>

<!-- åº•éƒ¨ç»“ç®—æ  -->
<view class="bottom-bar safe-area-bottom" wx:if="{{cartList.length > 0}}">
  <view class="bar-left" bindtap="onToggleAll">
    <view class="checkbox {{allChecked ? 'checked' : ''}}">
      <text wx:if="{{allChecked}}">âœ“</text>
    </view>
    <text class="bar-all-text">å…¨é€‰</text>
  </view>
  <view class="bar-right">
    <view class="bar-total">
      <text class="bar-total-label">åˆè®¡</text>
      <text class="bar-total-price"><text class="price-symbol">Â¥</text>{{totalPrice}}</text>
    </view>
    <button class="bar-checkout-btn" bindtap="onCheckout" disabled="{{checkedCount === 0}}">ç»“ç®—({{checkedCount}})</button>
  </view>
</view>
