# é¡¹ç›®å¯åŠ¨æŒ‡å—

## ğŸ“‹ é¡¹ç›®ç»“æ„æ¦‚è§ˆ

```
xiaodiyanxuan/
â”œâ”€â”€ å°ç¨‹åºå‰ç«¯/          # å¾®ä¿¡å°ç¨‹åºï¼ˆå·²å®Œæˆæ¡†æ¶ï¼‰
â”œâ”€â”€ web-frontend/        # Web å‰ç«¯ï¼ˆå¾…å¼€å‘ï¼‰
â”œâ”€â”€ backend/             # åç«¯æœåŠ¡ï¼ˆå¾…å¼€å‘ï¼‰
â””â”€â”€ æ–‡æ¡£/
    â”œâ”€â”€ åç«¯é¡¹ç›®å¼€å‘æç¤ºè¯.md
    â”œâ”€â”€ Webå‰ç«¯é¡¹ç›®å¼€å‘æç¤ºè¯.md
    â”œâ”€â”€ å…¨æ ˆå¯¹æ¥æŒ‡å—.md
    â”œâ”€â”€ APIæ¥å£é€ŸæŸ¥è¡¨.md
    â”œâ”€â”€ å‰ç«¯å¼€å‘åŠŸèƒ½æ–‡æ¡£ä¸APIæ¥å£è¦æ±‚.md
    â”œâ”€â”€ APIæ¥å£å¯¹æ¥æ–‡æ¡£.md
    â””â”€â”€ é¡¹ç›®å¯åŠ¨æŒ‡å—.mdï¼ˆæœ¬æ–‡ä»¶ï¼‰
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥ï¼šåç«¯æœåŠ¡å¯åŠ¨

#### 1. åˆ›å»ºåç«¯é¡¹ç›®

```bash
# åˆ›å»ºé¡¹ç›®ç›®å½•
mkdir backend
cd backend

# åˆå§‹åŒ– Node.js é¡¹ç›®
npm init -y

# å®‰è£…ä¾èµ–
npm install express mongoose jsonwebtoken bcryptjs dotenv cors helmet morgan axios multer joi
npm install -D nodemon
```

#### 2. é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```
PORT=5000
NODE_ENV=development
MONGODB_URI=mongodb://localhost:27017/xiaodiyanxuan
JWT_SECRET=your_jwt_secret_key_here_change_in_production
JWT_EXPIRE=7d
WECHAT_APPID=your_wechat_appid
WECHAT_APPSECRET=your_wechat_appsecret
CORS_ORIGIN=http://localhost:3000,http://localhost:8080,http://localhost:5173
```

#### 3. åˆ›å»ºåŸºç¡€é¡¹ç›®ç»“æ„

```bash
mkdir -p src/{config,models,routes,controllers,middleware,services,utils}
touch src/app.js server.js
```

#### 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
# æ·»åŠ  npm script åˆ° package.json
"scripts": {
  "dev": "nodemon server.js",
  "start": "node server.js"
}

# å¯åŠ¨
npm run dev
```

**é¢„æœŸè¾“å‡º**ï¼š
```
Server running on port 5000
MongoDB connected
```

---

### ç¬¬äºŒæ­¥ï¼šWeb å‰ç«¯å¯åŠ¨

#### 1. åˆ›å»º React é¡¹ç›®

```bash
# ä½¿ç”¨ Vite åˆ›å»ºé¡¹ç›®
npm create vite@latest web-frontend -- --template react-ts

cd web-frontend

# å®‰è£…ä¾èµ–
npm install
npm install react-router-dom axios zustand react-hook-form zod @hookform/resolvers
npm install -D tailwindcss postcss autoprefixer
npm install lucide-react clsx class-variance-authority

# åˆå§‹åŒ– Tailwind
npx tailwindcss init -p
```

#### 2. é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env.local` æ–‡ä»¶ï¼š

```
VITE_API_URL=http://localhost:5000
VITE_APP_NAME=å°ç¨‹åºå•†åŸ
VITE_APP_VERSION=1.0.0
```

#### 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

**é¢„æœŸè¾“å‡º**ï¼š
```
  VITE v4.x.x  ready in xxx ms

  âœ  Local:   http://localhost:5173/
  âœ  press h to show help
```

---

### ç¬¬ä¸‰æ­¥ï¼šå°ç¨‹åºå‰ç«¯å¯åŠ¨

#### 1. é…ç½® API åœ°å€

ç¼–è¾‘ `config/api.js`ï¼š

```javascript
const config = {
  baseURL: 'http://localhost:5000',  // æ”¹ä¸ºä½ çš„åç«¯åœ°å€
  timeout: 10000,
  debug: true
}

module.exports = config
```

#### 2. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æ‰“å¼€

1. æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·
2. é€‰æ‹©"æ‰“å¼€"
3. é€‰æ‹©é¡¹ç›®ç›®å½•ï¼ˆxiaodiyanxuan1ï¼‰
4. ç‚¹å‡»"æ‰“å¼€"

#### 3. é…ç½®å¼€å‘ç¯å¢ƒ

åœ¨å¼€å‘è€…å·¥å…·ä¸­ï¼š
- ç‚¹å‡»"è¯¦æƒ…" â†’ "æœ¬åœ°è®¾ç½®"
- å‹¾é€‰"ä¸æ ¡éªŒåˆæ³•åŸŸåã€web-viewï¼ˆä¸šåŠ¡åŸŸåï¼‰ã€TLS ç‰ˆæœ¬ä»¥åŠ HTTPS è¯ä¹¦"

---

## ğŸ§ª æµ‹è¯•å„ç«¯è¿æ¥

### 1. åç«¯ API æµ‹è¯•

ä½¿ç”¨ Postman æˆ– curl æµ‹è¯•ï¼š

```bash
# æµ‹è¯•åç«¯æ˜¯å¦è¿è¡Œ
curl http://localhost:5000/api/home

# é¢„æœŸå“åº”
{
  "code": 0,
  "message": "success",
  "data": { ... }
}
```

### 2. Web å‰ç«¯æµ‹è¯•

1. æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:5173`
2. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
3. æŸ¥çœ‹ Network æ ‡ç­¾ï¼Œç¡®è®¤ API è¯·æ±‚æˆåŠŸ

### 3. å°ç¨‹åºæµ‹è¯•

1. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æ‰“å¼€é¡¹ç›®
2. æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º
3. ç¡®è®¤ API è¯·æ±‚æˆåŠŸ

---

## ğŸ“Š å¼€å‘æµç¨‹

### é˜¶æ®µ 1ï¼šåç«¯å¼€å‘ï¼ˆ1-2 å‘¨ï¼‰

**ä¼˜å…ˆçº§**ï¼šğŸ”´ æœ€é«˜

**ä»»åŠ¡**ï¼š
1. [ ] æ•°æ®åº“è®¾è®¡å’Œå»ºæ¨¡
2. [ ] è®¤è¯ç³»ç»Ÿï¼ˆå¾®ä¿¡ç™»å½•ï¼‰
3. [ ] å•†å“æ¨¡å— API
4. [ ] è®¢å•æ¨¡å— API
5. [ ] å…¶ä»–æ¨¡å— API
6. [ ] æµ‹è¯•å’Œä¼˜åŒ–

**å‚è€ƒæ–‡æ¡£**ï¼š`åç«¯é¡¹ç›®å¼€å‘æç¤ºè¯.md`

### é˜¶æ®µ 2ï¼šWeb å‰ç«¯å¼€å‘ï¼ˆ1-2 å‘¨ï¼‰

**ä¼˜å…ˆçº§**ï¼šğŸŸ¡ ä¸­ç­‰

**ä»»åŠ¡**ï¼š
1. [ ] é¡¹ç›®åˆå§‹åŒ–å’Œé…ç½®
2. [ ] åŸºç¡€æ¡†æ¶æ­å»º
3. [ ] é¡µé¢å¼€å‘
4. [ ] åŠŸèƒ½é›†æˆ
5. [ ] æµ‹è¯•å’Œä¼˜åŒ–

**å‚è€ƒæ–‡æ¡£**ï¼š`Webå‰ç«¯é¡¹ç›®å¼€å‘æç¤ºè¯.md`

### é˜¶æ®µ 3ï¼šå°ç¨‹åºå¯¹æ¥ï¼ˆ1 å‘¨ï¼‰

**ä¼˜å…ˆçº§**ï¼šğŸŸ¢ ä½

**ä»»åŠ¡**ï¼š
1. [ ] é…ç½®åç«¯ API åœ°å€
2. [ ] æµ‹è¯•å„ä¸ªåŠŸèƒ½
3. [ ] ä¿®å¤ bug
4. [ ] æ€§èƒ½ä¼˜åŒ–

**å‚è€ƒæ–‡æ¡£**ï¼š`å‰ç«¯å¼€å‘åŠŸèƒ½æ–‡æ¡£ä¸APIæ¥å£è¦æ±‚.md`

---

## ğŸ”„ æ•°æ®æµç¤ºä¾‹

### ç”¨æˆ·ç™»å½•æµç¨‹

```
å°ç¨‹åº/Web â†’ è°ƒç”¨ wx.login() / è·å– code
         â†“
      åç«¯ â†’ éªŒè¯ codeï¼Œè·å– openId
         â†“
      åç«¯ â†’ ç”Ÿæˆ JWT Token
         â†“
å°ç¨‹åº/Web â†’ ä¿å­˜ Token åˆ°æœ¬åœ°
         â†“
å°ç¨‹åº/Web â†’ åç»­è¯·æ±‚éƒ½å¸¦ä¸Š Token
```

### å•†å“è´­ä¹°æµç¨‹

```
å°ç¨‹åº/Web â†’ è·å–å•†å“åˆ—è¡¨ GET /api/goods/list
         â†“
å°ç¨‹åº/Web â†’ æŸ¥çœ‹å•†å“è¯¦æƒ… GET /api/goods/:id
         â†“
å°ç¨‹åº/Web â†’ æ·»åŠ åˆ°è´­ç‰©è½¦ POST /api/cart
         â†“
å°ç¨‹åº/Web â†’ æŸ¥çœ‹è´­ç‰©è½¦ GET /api/cart
         â†“
å°ç¨‹åº/Web â†’ åˆ›å»ºè®¢å• POST /api/orders
         â†“
å°ç¨‹åº/Web â†’ æŸ¥çœ‹è®¢å• GET /api/orders/:orderId
```

---

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

### åç«¯

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
npm start

# è¿è¡Œæµ‹è¯•
npm test

# æ„å»º
npm run build
```

### Web å‰ç«¯

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# é¢„è§ˆç”Ÿäº§ç‰ˆæœ¬
npm run preview

# è¿è¡Œæµ‹è¯•
npm test

# ä»£ç æ£€æŸ¥
npm run lint
```

### å°ç¨‹åº

åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ï¼š
- ç¼–è¯‘ï¼šCtrl + Bï¼ˆWindowsï¼‰/ Cmd + Bï¼ˆMacï¼‰
- æ¸…é™¤ç¼“å­˜ï¼šå·¥å…· â†’ æ¸…é™¤ç¼“å­˜ â†’ æ¸…é™¤æ–‡ä»¶ç¼“å­˜
- ä¸Šä¼ ï¼šä¸Šä¼  â†’ è¾“å…¥ç‰ˆæœ¬å· â†’ ä¸Šä¼ 

---

## ğŸ“ æ•°æ®åº“åˆå§‹åŒ–

### 1. å®‰è£… MongoDB

**Windows**ï¼š
```bash
# ä½¿ç”¨ Chocolatey
choco install mongodb-community

# æˆ–ä¸‹è½½å®‰è£…ç¨‹åº
# https://www.mongodb.com/try/download/community
```

**Mac**ï¼š
```bash
# ä½¿ç”¨ Homebrew
brew tap mongodb/brew
brew install mongodb-community

# å¯åŠ¨ MongoDB
brew services start mongodb-community
```

**Linux**ï¼š
```bash
# Ubuntu/Debian
sudo apt-get install -y mongodb

# å¯åŠ¨ MongoDB
sudo systemctl start mongodb
```

### 2. åˆ›å»ºæ•°æ®åº“

```bash
# è¿æ¥åˆ° MongoDB
mongosh

# åˆ›å»ºæ•°æ®åº“
use xiaodiyanxuan

# åˆ›å»ºé›†åˆ
db.createCollection("users")
db.createCollection("goods")
db.createCollection("orders")
# ... å…¶ä»–é›†åˆ
```

### 3. å¯¼å…¥ç¤ºä¾‹æ•°æ®

åœ¨åç«¯é¡¹ç›®ä¸­åˆ›å»º `scripts/seed.js`ï¼š

```javascript
const mongoose = require('mongoose')
const Goods = require('../src/models/Goods')

async function seedData() {
  await mongoose.connect(process.env.MONGODB_URI)
  
  // æ¸…ç©ºç°æœ‰æ•°æ®
  await Goods.deleteMany({})
  
  // æ’å…¥ç¤ºä¾‹æ•°æ®
  await Goods.insertMany([
    {
      id: 'g1',
      name: 'è«å…°è¿ªæ²™å‘',
      code: 'FS-SF3201',
      price: 2699,
      // ... å…¶ä»–å­—æ®µ
    },
    // ... æ›´å¤šå•†å“
  ])
  
  console.log('æ•°æ®å¯¼å…¥æˆåŠŸ')
  process.exit(0)
}

seedData().catch(err => {
  console.error(err)
  process.exit(1)
})
```

è¿è¡Œï¼š
```bash
node scripts/seed.js
```

---

## ğŸ” å®‰å…¨é…ç½®

### 1. ç¯å¢ƒå˜é‡

**ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯**ï¼š

```javascript
// âŒ é”™è¯¯
const JWT_SECRET = 'my_secret_key'

// âœ… æ­£ç¡®
const JWT_SECRET = process.env.JWT_SECRET
```

### 2. CORS é…ç½®

```javascript
// åç«¯ app.js
const cors = require('cors')

app.use(cors({
  origin: process.env.CORS_ORIGIN.split(','),
  credentials: true
}))
```

### 3. HTTPS

ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨ HTTPSï¼š

```javascript
// ä½¿ç”¨ Let's Encrypt è·å–å…è´¹è¯ä¹¦
// https://letsencrypt.org/

// æˆ–ä½¿ç”¨ Nginx åå‘ä»£ç†
```

---

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### 1. åç«¯æ—¥å¿—

```javascript
// ä½¿ç”¨ morgan è®°å½•è¯·æ±‚æ—¥å¿—
const morgan = require('morgan')
app.use(morgan('combined'))

// ä½¿ç”¨ winston è®°å½•åº”ç”¨æ—¥å¿—
const winston = require('winston')
const logger = winston.createLogger({
  level: 'info',
  format: winston.format.json(),
  transports: [
    new winston.transports.File({ filename: 'error.log', level: 'error' }),
    new winston.transports.File({ filename: 'combined.log' })
  ]
})
```

### 2. å‰ç«¯é”™è¯¯è¿½è¸ª

```javascript
// ä½¿ç”¨ Sentry è¿½è¸ªé”™è¯¯
import * as Sentry from "@sentry/react"

Sentry.init({
  dsn: "your-sentry-dsn",
  environment: process.env.NODE_ENV
})
```

---

## ğŸš€ éƒ¨ç½²æ¸…å•

### åç«¯éƒ¨ç½²

- [ ] é…ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡
- [ ] é…ç½® HTTPS è¯ä¹¦
- [ ] é…ç½®æ•°æ®åº“å¤‡ä»½
- [ ] é…ç½®æ—¥å¿—æ”¶é›†
- [ ] é…ç½®ç›‘æ§å‘Šè­¦
- [ ] é…ç½® CI/CD æµç¨‹
- [ ] æ€§èƒ½æµ‹è¯•
- [ ] å®‰å…¨å®¡è®¡

### Web å‰ç«¯éƒ¨ç½²

- [ ] æ„å»ºç”Ÿäº§ç‰ˆæœ¬
- [ ] é…ç½® CDN
- [ ] é…ç½®ç¼“å­˜ç­–ç•¥
- [ ] é…ç½® Gzip å‹ç¼©
- [ ] æ€§èƒ½æµ‹è¯•
- [ ] SEO ä¼˜åŒ–

### å°ç¨‹åºéƒ¨ç½²

- [ ] é…ç½®åˆæ³•åŸŸå
- [ ] ä¸Šä¼ ä»£ç 
- [ ] æäº¤å®¡æ ¸
- [ ] å‘å¸ƒä¸Šçº¿

---

## ğŸ“ æ•…éšœæ’æŸ¥

### åç«¯æ— æ³•å¯åŠ¨

```bash
# æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
lsof -i :5000  # Mac/Linux
netstat -ano | findstr :5000  # Windows

# æ€æ­»å ç”¨ç«¯å£çš„è¿›ç¨‹
kill -9 <PID>  # Mac/Linux
taskkill /PID <PID> /F  # Windows
```

### æ•°æ®åº“è¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥ MongoDB æ˜¯å¦è¿è¡Œ
mongosh

# æ£€æŸ¥è¿æ¥å­—ç¬¦ä¸²
# mongodb://localhost:27017/xiaodiyanxuan
```

### å‰ç«¯ API è¯·æ±‚å¤±è´¥

1. æ£€æŸ¥åç«¯æ˜¯å¦è¿è¡Œ
2. æ£€æŸ¥ API åœ°å€æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥ CORS é…ç½®
4. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

### å°ç¨‹åºè¯·æ±‚å¤±è´¥

1. æ£€æŸ¥åŸŸåé…ç½®
2. æ£€æŸ¥ token æ˜¯å¦æ­£ç¡®
3. æŸ¥çœ‹å¼€å‘è€…å·¥å…·æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

---

## ğŸ“š ç›¸å…³èµ„æº

- **åç«¯å¼€å‘æç¤ºè¯**ï¼š`åç«¯é¡¹ç›®å¼€å‘æç¤ºè¯.md`
- **Web å‰ç«¯å¼€å‘æç¤ºè¯**ï¼š`Webå‰ç«¯é¡¹ç›®å¼€å‘æç¤ºè¯.md`
- **å…¨æ ˆå¯¹æ¥æŒ‡å—**ï¼š`å…¨æ ˆå¯¹æ¥æŒ‡å—.md`
- **API æ¥å£é€ŸæŸ¥è¡¨**ï¼š`APIæ¥å£é€ŸæŸ¥è¡¨.md`

---

## âœ… å¯åŠ¨æ£€æŸ¥æ¸…å•

- [ ] åç«¯æœåŠ¡è¿è¡Œæ­£å¸¸ï¼ˆhttp://localhost:5000ï¼‰
- [ ] MongoDB æ•°æ®åº“è¿æ¥æˆåŠŸ
- [ ] Web å‰ç«¯å¼€å‘æœåŠ¡è¿è¡Œæ­£å¸¸ï¼ˆhttp://localhost:5173ï¼‰
- [ ] å°ç¨‹åºåœ¨å¼€å‘è€…å·¥å…·ä¸­æ‰“å¼€
- [ ] ä¸‰ç«¯éƒ½èƒ½è®¿é—® API
- [ ] ç™»å½•åŠŸèƒ½æ­£å¸¸
- [ ] å•†å“åˆ—è¡¨èƒ½æ­£å¸¸åŠ è½½
- [ ] è´­ç‰©è½¦åŠŸèƒ½æ­£å¸¸
- [ ] è®¢å•åˆ›å»ºåŠŸèƒ½æ­£å¸¸

---

**æœ€åæ›´æ–°**ï¼š2024å¹´11æœˆ17æ—¥  
**ç‰ˆæœ¬**ï¼š1.0.0

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒç›¸å…³æ–‡æ¡£æˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚
