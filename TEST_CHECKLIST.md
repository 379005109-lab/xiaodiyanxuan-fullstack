# 🧪 完整测试清单

## ⚠️ **重要：先清空本地数据！**

```javascript
// 在浏览器控制台执行：
localStorage.clear()
sessionStorage.clear()
location.reload()
```

---

## 1️⃣ 购物车结算按钮测试

### 步骤：
1. **清空浏览器缓存和localStorage**
2. **添加商品到购物车**：
   - 进入任意商品详情页
   - 选择规格和材质
   - 点击"加入购物车"
   
3. **检查购物车页面**：
   - [ ] 能看到商品列表
   - [ ] 能看到复选框
   - [ ] **底部有"立即结算"按钮（固定在底部，z-index: 50）**
   - [ ] 按钮在页面滚动时保持固定

### 预期结果：
```
✅ 结算按钮在底部固定显示
✅ 点击后跳转到结算页面
```

### 调试信息（浏览器控制台）：
```
🛒 购物车数量: X
📦 商品1: { name, spec, selectedMaterials, materialUpgradePrices, ... }
📊 结算按钮应该显示: true
```

---

## 2️⃣ 购物车显示规格、加价信息测试

### 步骤：
1. **清空购物车**（点击"清空购物车"按钮）
2. **添加带材质选择的商品**：
   - 选择一个有"面料"、"填充"等选项的商品
   - 选择升级材质（有加价的）
   - 添加到购物车

3. **检查购物车页面显示**：
   - [ ] 显示"规格: XXX"
   - [ ] 显示"面料: XXX +¥XXX"（红色加价）
   - [ ] 显示"填充: XXX +¥XXX"（红色加价）
   - [ ] 显示"框架: XXX +¥XXX"（如果选择了）
   - [ ] 显示"脚架: XXX +¥XXX"（如果选择了）

### 预期结果：
```
规格: 1.8m
面料: 全青皮 +¥500
填充: 高弹海绵 +¥200
```

### ⚠️ 如果看不到加价信息：
```javascript
// 检查localStorage中的数据
console.log(JSON.parse(localStorage.getItem('cart-storage') || '{}'))
// 应该看到每个item都有materialUpgradePrices字段
```

---

## 3️⃣ 订单显示规格、加价信息测试

### 步骤：
1. **提交订单**（从购物车结算）
2. **填写收货信息并提交**
3. **进入"我的订单"页面**
4. **检查订单详情**：
   - [ ] 显示规格信息
   - [ ] 显示材质信息（面料、填充等）
   - [ ] 显示加价信息（红色字体）

### 预期结果：
```
规格: 1.8m
面料: 全青皮 +¥500
填充: 高弹海绵 +¥200
```

---

## 4️⃣ 陪买服务测试

### 步骤：
1. **登录账号**
2. **进入陪买服务页面**（导航栏）
3. **选择服务类型**（标准版/尊享版）
4. **选择日期**
5. **点击"立即预约"**

### 检查后台：
1. **进入管理后台**
2. **订单管理 → 陪买预约**
3. **应该能看到刚才的预约记录**

### 预期结果：
```
✅ 前端提示"预约成功"
✅ 后台能看到新的预约记录
✅ 记录包含：用户信息、服务类型、预约时间
```

### 调试（后端日志）：
```bash
kubectl logs -l app=xiaodiyanxuan-api --tail=50 | grep "陪买"
```

---

## 5️⃣ 客户请求取消显示测试

### 步骤：
1. **在"我的订单"中找一个订单**
2. **点击"取消订单"按钮**
3. **确认取消**
4. **进入管理后台**
5. **订单管理 → 订单列表**
6. **找到该订单**

### 检查管理后台订单卡片：
- [ ] 订单状态旁边有**"客户请求取消"橙色标记**
- [ ] 标记显示在订单卡片的头部

### 预期显示：
```
[待付款] [客户请求取消] 2024-01-01
```

---

## 6️⃣ 综合测试流程

### 完整购物流程：
1. ✅ 清空localStorage
2. ✅ 浏览商品
3. ✅ 选择材质（有加价的）
4. ✅ 添加到购物车
5. ✅ 查看购物车（检查规格、加价）
6. ✅ 勾选商品
7. ✅ 点击结算按钮
8. ✅ 填写收货信息
9. ✅ 提交订单
10. ✅ 查看订单详情（检查规格、加价）
11. ✅ 请求取消订单
12. ✅ 管理后台查看取消请求标记

---

## 🐛 常见问题排查

### 问题1：购物车看不到加价信息
**解决**：
```javascript
// 1. 清空购物车
localStorage.removeItem('cart-storage')

// 2. 重新添加商品（从商品详情页）
// 3. 检查数据
console.log(JSON.parse(localStorage.getItem('cart-storage') || '{}'))
```

### 问题2：结算按钮消失
**检查**：
- 购物车是否有商品（items.length > 0）
- 浏览器控制台是否有报错
- 检查z-index是否被覆盖

### 问题3：订单看不到材质信息
**原因**：
- 订单是在修复前提交的
- 需要提交新订单才能看到完整信息

### 问题4：陪买服务提交失败
**检查**：
- 用户是否已登录
- 浏览器控制台Network标签查看API响应
- 后端日志查看错误信息

---

## 📋 检查清单总结

- [ ] 1. 购物车结算按钮显示正常
- [ ] 2. 购物车显示规格和加价信息
- [ ] 3. 订单显示规格和加价信息
- [ ] 4. 陪买服务提交成功并在后台显示
- [ ] 5. 取消请求标记在管理后台显示
- [ ] 6. 完整购物流程无报错

**全部完成后，所有问题应该都已解决！**
