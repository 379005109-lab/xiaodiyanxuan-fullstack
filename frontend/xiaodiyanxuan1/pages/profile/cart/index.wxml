<navigation-bar title="è´­ç‰©è½¦" back="{{true}}" color="black" background="#FFF"></navigation-bar>
<scroll-view class="scrollarea" scroll-y>
  <view class="page">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <view class="page-header">
      <view class="page-title">è´­ç‰©è½¦</view>
      <view class="page-subtitle">SHOPPING CART ({{cartList.length}})</view>
    </view>
    
    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty" wx:if="{{cartList.length === 0}}">
      <view class="empty-icon-box">â—‹</view>
      <view class="empty-text">è´­ç‰©è½¦æ˜¯ç©ºçš„</view>
      <view class="empty-tip">å¿«å»æŒ‘é€‰å¿ƒä»ªçš„å•†å“å§</view>
      <button class="btn-primary" bindtap="goMall">å»é€›é€›</button>
    </view>

    <!-- å…¨é€‰æ  -->
    <view class="select-bar" wx:if="{{cartList.length > 0}}">
      <view class="select-left" bindtap="onToggleAll">
        <view class="check-box {{allChecked ? 'checked' : ''}}">
          <text wx:if="{{allChecked}}">âœ“</text>
        </view>
        <text class="select-text">å…¨é€‰ ({{cartList.length}})</text>
      </view>
      <view class="select-right">
        <text class="selected-info">å·²é€‰æ‹© {{checkedCount}} ä»¶å•†å“</text>
      </view>
    </view>

    <!-- è´­ç‰©è½¦åˆ—è¡¨ - æ¯ä¸ªå•†å“ç‹¬ç«‹å¡ç‰‡ -->
    <view class="cart-list" wx:if="{{cartList.length > 0}}">
      <view class="cart-card" wx:for="{{cartList}}" wx:key="id">
        <!-- å•†å“å¤´éƒ¨ï¼šå¤é€‰æ¡†å’Œåˆ é™¤ -->
        <view class="cart-header">
          <view class="check-box {{item.checked ? 'checked' : ''}}" bindtap="onToggleCheck" data-index="{{index}}">
            <text wx:if="{{item.checked}}">âœ“</text>
          </view>
          <view class="delete-icon" catchtap="onDelete" data-index="{{index}}">ğŸ—‘</view>
        </view>
        <!-- å•†å“å†…å®¹ -->
        <view class="cart-content">
          <image class="cart-thumb" src="{{item.thumb}}" mode="aspectFill" bindtap="goDetail" data-id="{{item.id}}"></image>
          <view class="cart-info">
            <view class="cart-name">{{item.name}}</view>
            <view class="cart-spec-row">è§„æ ¼: {{item.sizeName || 'é»˜è®¤'}}</view>
            <view class="cart-spec-row" wx:if="{{item.dims}}">å°ºå¯¸: {{item.dims}}</view>
            <!-- æè´¨ä¿¡æ¯ -->
            <view class="cart-material-list">
              <view class="cart-material-item" wx:if="{{item.fabric || item.material}}">é¢æ–™: {{item.fabric || item.material}}{{item.materialColor ? '-' + item.materialColor : ''}}</view>
              <view class="cart-material-item" wx:if="{{item.fill}}">å¡«å……: {{item.fill}}{{item.fillExtra > 0 ? '+' + item.fillExtra : ''}}</view>
              <view class="cart-material-item" wx:if="{{item.frame}}">æ¡†æ¶: {{item.frame}}</view>
              <view class="cart-material-item" wx:if="{{item.leg}}">è…¿è„š: {{item.leg}}</view>
            </view>
          </view>
        </view>
        <!-- ä»·æ ¼å’Œæ•°é‡ -->
        <view class="cart-footer">
          <text class="cart-price">Â¥{{item.price}}</text>
          <view class="quantity-control">
            <view class="qty-btn" bindtap="onDecrease" data-index="{{index}}">âˆ’</view>
            <view class="qty-value">{{item.count || 1}}</view>
            <view class="qty-btn" bindtap="onIncrease" data-index="{{index}}">+</view>
          </view>
        </view>
      </view>
    </view>
  </view>
</scroll-view>

<!-- åº•éƒ¨ç»“ç®—æ  -->
<view class="bottom-bar" wx:if="{{cartList.length > 0}}">
  <view class="bar-left">
    <text class="total-label">åˆè®¡</text>
    <text class="total-price">Â¥{{totalPrice}}</text>
  </view>
  <button class="btn-checkout" bindtap="onCheckout" disabled="{{checkedCount === 0}}">ç»“ç®—({{checkedCount}})</button>
</view>
