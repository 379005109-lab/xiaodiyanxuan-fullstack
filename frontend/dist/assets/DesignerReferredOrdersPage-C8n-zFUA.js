import{j as e,f as s,v as t}from"./index-DWFic46w.js";import{r as a}from"./react-vendor-E1AgTUZ9.js";import{u as l,S as r,ak as i,c,aQ as d}from"./ui-vendor-CQy3HONI.js";import{m as n}from"./framer-motion-7DcRqacn.js";import"./recharts-wIacPPq0.js";function x(){const[x,m]=a.useState([]),[o,p]=a.useState(!0),[h,j]=a.useState(""),[g,u]=a.useState(""),[N,b]=a.useState(null);a.useEffect(()=>{f()},[]);const f=()=>{p(!0);try{const e=JSON.parse(localStorage.getItem("designer_referred_orders")||"[]");m(e)}catch(e){l.error("加载订单失败")}finally{p(!1)}},v=x.filter(e=>!(h&&!e.orderNumber.includes(h)&&!e.customerName.includes(h))&&(!g||e.status===g)).sort((e,s)=>new Date(s.createdAt).getTime()-new Date(e.createdAt).getTime()),y=v.filter(e=>"completed"===e.status).reduce((e,s)=>e+s.commission,0),w=s=>{const t={pending:{bg:"bg-amber-50",text:"text-amber-700",label:"待提交"},processing:{bg:"bg-blue-50",text:"text-blue-700",label:"处理中"},completed:{bg:"bg-green-50",text:"text-green-700",label:"已完成"},cancelled:{bg:"bg-red-50",text:"text-red-700",label:"已取消"}},a=t[s]||t.pending;return e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm font-medium ${a.bg} ${a.text}`,children:a.label})};return o?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"推荐客户订单"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"通过设计分享链接进入购买的订单"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"总订单数"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:x.length})]}),e.jsxs("div",{className:"card",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"已完成订单"}),e.jsx("p",{className:"text-3xl font-bold text-green-600 mt-2",children:x.filter(e=>"completed"===e.status).length})]}),e.jsxs("div",{className:"card",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"累计佣金"}),e.jsx("p",{className:"text-3xl font-bold text-primary-600 mt-2",children:s(y)})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(r,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",value:h,onChange:e=>j(e.target.value),placeholder:"搜索订单号或客户名称...",className:"input pl-10 w-full"})]}),e.jsx("div",{className:"w-full md:w-40",children:e.jsxs("select",{value:g,onChange:e=>u(e.target.value),className:"input w-full",children:[e.jsx("option",{value:"",children:"所有状态"}),e.jsx("option",{value:"pending",children:"待处理"}),e.jsx("option",{value:"processing",children:"处理中"}),e.jsx("option",{value:"completed",children:"已完成"}),e.jsx("option",{value:"cancelled",children:"已取消"})]})})]})}),e.jsx("div",{className:"space-y-4",children:0===v.length?e.jsx("div",{className:"card text-center py-12",children:e.jsx("p",{className:"text-gray-600",children:"暂无推荐订单"})}):v.map(a=>e.jsxs("div",{className:"card hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>b(N===a.id?null:a.id),children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:["订单号: ",a.orderNumber]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["客户: ",a.customerName]})]})})}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-bold text-primary-600",children:s(a.totalAmount)}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:t(a.createdAt)})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[w(a.status),N===a.id?e.jsx(i,{className:"h-5 w-5 text-gray-400"}):e.jsx(c,{className:"h-5 w-5 text-gray-400"})]})]})]}),N===a.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"订单商品"}),e.jsx("div",{className:"space-y-2",children:a.items.map((t,a)=>e.jsxs("div",{className:"flex justify-between items-center py-2 px-3 bg-gray-50 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.productName}),e.jsxs("p",{className:"text-xs text-gray-600",children:["数量: ",t.quantity]})]}),e.jsx("p",{className:"font-semibold text-gray-900",children:s(t.price*t.quantity)})]},a))})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"订单金额"}),e.jsx("p",{className:"text-lg font-bold text-blue-900 mt-1",children:s(a.totalAmount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"可获佣金"}),e.jsx("p",{className:"text-lg font-bold text-blue-900 mt-1",children:s(a.commission)})]})]})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"分享链接"}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded border border-gray-200",children:[e.jsx(d,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:a.referralLink,readOnly:!0,className:"flex-1 bg-transparent text-sm text-gray-600 outline-none"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(a.referralLink),l.success("链接已复制")},className:"text-xs px-3 py-1 bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:"复制"})]})]})]})]},a.id))})]})}export{x as default};
