import{b as e,m as s,c as a,j as t,f as r,z as l}from"./index-DWFic46w.js";import{i,u as c,r as d}from"./react-vendor-E1AgTUZ9.js";import{u as n,v as x,aa as m}from"./ui-vendor-CQy3HONI.js";import{c as o,g as h}from"./categoryHelper-xKgG4ELc.js";import{m as b}from"./framer-motion-7DcRqacn.js";import"./recharts-wIacPPq0.js";function p(){const{id:p}=i(),j=c(),{user:g}=e(),[u,N]=d.useState(null),[y,f]=d.useState([]),[v,w]=d.useState(new Map),[k,S]=d.useState(!0),[O,K]=d.useState(!1),[P,U]=d.useState([]);d.useEffect(()=>{A()},[p]);const A=async()=>{S(!0);try{if(p){const e=await s(p);e&&(N(e),U(e.skus||[]))}const e=await a();f(e),w(o(e))}catch(e){n.error("åŠ è½½æ•°æ®å¤±è´¥")}finally{S(!1)}},R=e=>h(v,null==g?void 0:g.role,e);return k?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):u?(R(u.category),t.jsx(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"min-h-screen bg-gradient-to-b from-gray-50 to-white py-8",children:t.jsxs("div",{className:"max-w-5xl mx-auto px-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>j("/admin/products"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:t.jsx(x,{className:"h-6 w-6 text-gray-700"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:u.name}),t.jsx("p",{className:"text-gray-600 mt-1",children:"è®¾è®¡å¸ˆä»·æ ¼ç¼–è¾‘å·¥ä½œå°"})]})]}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[t.jsx("div",{className:"md:col-span-1",children:u.images&&u.images.length>0?t.jsx("img",{src:u.images[0],alt:u.name,className:"w-full h-40 rounded-lg object-cover shadow-md"}):t.jsx("div",{className:"w-full h-40 rounded-lg bg-gray-100 flex items-center justify-center text-gray-400 text-sm",children:"æ— å›¾ç‰‡"})}),t.jsxs("div",{className:"md:col-span-2 space-y-4",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:u.name}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"è®¾è®¡å¸ˆä»·æ ¼ç¼–è¾‘å·¥ä½œå°"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-100",children:[t.jsx("p",{className:"text-xs font-semibold text-blue-900 uppercase tracking-wide mb-2",children:"è§„æ ¼"}),t.jsx("div",{className:"space-y-1",children:u.specifications&&Object.entries(u.specifications).length>0?Object.entries(u.specifications).map(([e,s])=>t.jsxs("div",{className:"text-xs",children:[t.jsx("p",{className:"text-blue-600 font-medium",children:e}),t.jsx("p",{className:"text-blue-900 font-semibold",children:s})]},e)):t.jsx("p",{className:"text-xs text-blue-600",children:"æ— è§„æ ¼"})})]}),t.jsxs("div",{className:"bg-amber-50 rounded-lg p-3 border border-amber-100",children:[t.jsx("p",{className:"text-xs font-semibold text-amber-900 uppercase tracking-wide mb-2",children:"æè´¨"}),t.jsx("div",{className:"space-y-1",children:P.length>0&&P[0].material&&Object.keys(P[0].material).length>0?Object.entries(P[0].material).map(([e,s])=>t.jsxs("div",{className:"text-xs",children:[t.jsx("p",{className:"text-amber-600 font-medium",children:e}),t.jsx("p",{className:"text-amber-900 font-semibold",children:"string"==typeof s?s:Array.isArray(s)?s.join(", "):"-"})]},e)):t.jsx("p",{className:"text-xs text-amber-600",children:"æ— æè´¨"})})]})]})]}),t.jsxs("div",{className:"md:col-span-1 space-y-3",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[t.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide font-semibold",children:"åˆ†ç±»"}),t.jsx("p",{className:"text-base font-bold text-gray-900 mt-1",children:u.category})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[t.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide font-semibold",children:"SKUæ•°é‡"}),t.jsxs("p",{className:"text-base font-bold text-gray-900 mt-1",children:[P.length," ä¸ª"]})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[t.jsx("p",{className:"text-xs font-semibold text-blue-900 mb-1",children:"ğŸ’¡ æç¤º"}),t.jsx("p",{className:"text-xs text-blue-700",children:"ç¼–è¾‘SKUå¯¹å¤–å±•ç¤ºä»·"})]})]})]})}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t.jsx("div",{className:"lg:col-span-2",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[t.jsx("h2",{className:"text-xl font-semibold mb-6 text-gray-900",children:"SKUè¯¦æƒ…ä¸ä»·æ ¼ç¼–è¾‘"}),t.jsx("div",{className:"space-y-6",children:P.map((e,s)=>{const a=e.price||0,l=e.discountPrice||0,i=(e=>{const s=R(null==u?void 0:u.category);return Math.round(e*s)})(l>0&&l<a?l:a);return t.jsxs("div",{className:"border border-gray-200 rounded-lg p-5 hover:shadow-md hover:border-primary-300 transition-all bg-white",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-base font-bold text-gray-900",children:e.spec||e.code||`SKU ${s+1}`}),e.code&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["å‹å·: ",e.code]})]}),e.isPro&&t.jsx("span",{className:"inline-block px-2 py-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs font-bold rounded-full ml-2",children:"PRO"})]}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide mb-3",children:"SKUå›¾ç‰‡"}),e.images&&e.images.length>0?t.jsx("div",{className:"w-full bg-gray-50 rounded-lg overflow-hidden flex items-center justify-center",style:{aspectRatio:"4/3"},children:t.jsx("img",{src:e.images[0],alt:e.spec||`SKU ${s+1}`,className:"w-full h-full object-contain"})}):t.jsx("div",{className:"w-full bg-gray-100 rounded-lg flex items-center justify-center text-gray-400 text-sm",style:{aspectRatio:"4/3"},children:"æ— å›¾ç‰‡"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-100",children:[t.jsx("p",{className:"text-xs font-semibold text-blue-900 uppercase tracking-wide mb-3",children:"è§„æ ¼"}),t.jsxs("div",{className:"space-y-2",children:[(e.length||e.width||e.height)&&t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"å°ºå¯¸"}),t.jsxs("p",{className:"text-sm text-blue-900 font-semibold mt-1",children:[e.length,"Ã—",e.width,"Ã—",e.height]})]}),!e.length&&!e.width&&!e.height&&t.jsx("p",{className:"text-sm text-blue-600",children:"æ— å°ºå¯¸ä¿¡æ¯"})]})]}),t.jsxs("div",{className:"bg-amber-50 rounded-lg p-4 border border-amber-100",children:[t.jsx("p",{className:"text-xs font-semibold text-amber-900 uppercase tracking-wide mb-3",children:"æè´¨"}),t.jsx("div",{className:"space-y-1",children:e.material&&"object"==typeof e.material&&Object.keys(e.material).length>0?Object.entries(e.material).map(([e,s])=>t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-amber-600 font-medium",children:e}),t.jsx("p",{className:"text-xs text-amber-900 font-semibold mt-0.5",children:"string"==typeof s?s:Array.isArray(s)?s.join(", "):"-"})]},e)):t.jsx("p",{className:"text-sm text-amber-600",children:"æ— æè´¨ä¿¡æ¯"})})]})]})]}),e.material&&"object"==typeof e.material&&Object.keys(e.material).length>0&&t.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[t.jsx("p",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide mb-3",children:"æè´¨å›¾ç‰‡"}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Object.entries(e.material).map(([e,s])=>t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-full bg-gray-100 rounded-lg overflow-hidden mb-2 flex items-center justify-center",style:{aspectRatio:"1/1"},children:t.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-200 to-gray-300 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl mb-1",children:"ğŸ¨"}),t.jsx("p",{className:"text-xs text-gray-600 font-medium",children:e})]})})}),t.jsx("p",{className:"text-xs text-gray-700 font-medium truncate",children:"string"==typeof s?s:Array.isArray(s)?s[0]:"-"})]},e))})]}),t.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[t.jsxs("div",{className:"flex items-baseline gap-2 mb-2",children:[t.jsx("span",{className:"text-xs text-gray-500",children:"å½“å‰ä»·æ ¼"}),t.jsx("span",{className:"text-2xl font-bold text-red-600",children:r(e.discountPrice||i)}),t.jsx("span",{className:"text-xs text-gray-400",children:"Â¥"})]}),t.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-600",children:[t.jsxs("span",{children:["ä¾›è´§ä»·: ",r(i)]}),e.proFeature&&t.jsxs("span",{className:"text-purple-600 font-medium",children:["PRO: ",e.proFeature]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"ç¼–è¾‘å¯¹å¤–å±•ç¤ºä»·"}),t.jsxs("div",{className:"relative mb-3",children:[t.jsx("span",{className:"absolute left-4 top-3.5 text-gray-500 font-bold text-lg",children:"Â¥"}),t.jsx("input",{type:"number",value:e.discountPrice||i,onChange:e=>((e,s,a)=>{const t=[...P],r=parseFloat(a)||0;t[e]={...t[e],[s]:r},U(t)})(s,"discountPrice",e.target.value),className:"input pl-10 w-full text-xl font-bold text-red-600 border-2 border-gray-300 focus:border-primary-500",step:"0.01",min:i,placeholder:`æœ€ä½ ${r(i)}`})]}),t.jsxs("p",{className:"text-xs text-gray-600 mb-3",children:["æœ€ä½ä»·æ ¼: ",t.jsx("span",{className:"font-semibold text-primary-600",children:r(i)})]}),t.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-xs text-blue-700 flex items-start gap-2",children:[t.jsx("span",{children:"â„¹ï¸"}),t.jsx("p",{children:"å¯¹å¤–å±•ç¤ºä»·ä¸èƒ½ä½äºä¾›è´§ä»·ï¼Œä¿®æ”¹åéœ€ç‚¹å‡»ä¿å­˜"})]})]})]},e._id||s)})})]})}),t.jsx("div",{className:"lg:col-span-1",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 sticky top-24 space-y-6",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide font-semibold mb-2",children:"å¿«é€Ÿç¼–è¾‘"}),t.jsx("p",{className:"text-sm text-gray-600",children:"é€‰æ‹©ä¸‹æ–¹SKUå¡ç‰‡è¿›è¡Œç¼–è¾‘ï¼Œè®¾ç½®å¯¹å¤–å±•ç¤ºä»·æ ¼"})]}),t.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-sm font-semibold text-amber-900 mb-2",children:"âš ï¸ é‡è¦æç¤º"}),t.jsxs("ul",{className:"text-xs text-amber-700 space-y-1",children:[t.jsx("li",{children:"â€¢ ä¾›è´§ä»·ç”±ç³»ç»Ÿè‡ªåŠ¨è®¡ç®—"}),t.jsx("li",{children:"â€¢ å¯¹å¤–ä»·ä¸èƒ½ä½äºä¾›è´§ä»·"}),t.jsx("li",{children:"â€¢ ä¿®æ”¹åéœ€ç‚¹å‡»ä¿å­˜"})]})]})]})})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-8",children:[t.jsx("button",{onClick:()=>j("/admin/products"),className:"btn-secondary",children:"å–æ¶ˆ"}),t.jsxs("button",{onClick:async()=>{if(u){K(!0);try{await l(u._id,{skus:P}),n.success("å•†å“å·²ä¿å­˜"),j("/admin/products")}catch(e){n.error("ä¿å­˜å¤±è´¥")}finally{K(!1)}}},disabled:O,className:"btn-primary flex items-center gap-2",children:[t.jsx(m,{className:"h-5 w-5"}),O?"ä¿å­˜ä¸­...":"ä¿å­˜"]})]})]})})):t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-600",children:"å•†å“ä¸å­˜åœ¨"})})}export{p as default};
