import{j as e}from"./index-DWFic46w.js";import{i as s,r as a}from"./react-vendor-E1AgTUZ9.js";import{w as t,Y as r,X as l,ac as n}from"./ui-vendor-CQy3HONI.js";import"./recharts-wIacPPq0.js";const i={id:1,name:"质感沙发 · 莫兰迪灰",originalPrice:3999,bargainPrice:2199,currentPrice:2899,helpers:[{id:1,name:"好友A",avatar:"/placeholder.svg",amount:150},{id:2,name:"设计师B",avatar:"/placeholder.svg",amount:200},{id:3,name:"好友C",avatar:"/placeholder.svg",amount:100}],imageUrl:"/placeholder.svg"},c=e=>{const[s,a]=e.split("-").map(Number);return Math.random()*(a-s)+s},d=()=>{const{id:l}=s(),[n,d]=a.useState(i),[m,x]=a.useState(!1),[h,b]=a.useState(!1),[g,j]=a.useState(!1),u=(n.originalPrice-n.currentPrice)/(n.originalPrice-n.bargainPrice)*100;return e.jsxs("div",{className:"bg-gray-100 min-h-screen p-4",children:[g&&e.jsx(o,{onClose:()=>j(!1)}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[m&&e.jsxs("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-4",role:"alert",children:[e.jsx("p",{className:"font-bold",children:"助力彩蛋！"}),e.jsx("p",{children:"新设计师好友助力，额外砍掉200元！该设计师已获专属佣金券。"})]}),e.jsxs("div",{className:"p-4 border-b",children:[e.jsx("img",{src:n.imageUrl,alt:n.name,className:"w-full h-64 object-cover rounded-lg"}),e.jsx("h2",{className:"text-xl font-bold mt-4",children:n.name}),e.jsx("div",{className:"flex items-baseline gap-2 mt-1",children:e.jsxs("span",{className:"text-sm text-gray-500 line-through",children:["原价: ¥",n.originalPrice]})})]}),e.jsxs("div",{className:"p-4 text-center",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["当前价: ",e.jsxs("span",{className:"text-red-500",children:["¥",n.currentPrice]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mt-2",children:e.jsxs("div",{className:"bg-orange-500 h-4 rounded-full text-white text-xs flex items-center justify-center",style:{width:`${Math.min(u,100)}%`},children:["已砍",Math.min(u,100).toFixed(0),"%"]})}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["已砍 ",e.jsxs("span",{className:"font-bold text-green-500",children:["¥",n.originalPrice-n.currentPrice]}),"，继续邀请好友砍价！"]})]}),e.jsxs("div",{className:"p-4 flex gap-4",children:[e.jsxs("button",{onClick:()=>j(!0),className:"btn btn-primary flex-1 flex items-center justify-center gap-2",children:[e.jsx(t,{size:20}),"分享给好友"]}),e.jsx("button",{onClick:()=>{const e=JSON.parse(localStorage.getItem(`bargain_rules_${l}`)||"null");if(!e)return void alert("该商品未配置砍价规则！");const s=n.originalPrice*(e.totalBargainPercent/100),a=n.helpers.length;let t=0;t=0===a?c(e.firstCutPercent):a>=1&&a<=4?c(e.nextFourCutsPercent)/4:c(e.remainingCutsPercent);let r=s*(t/100),i=!1;Math.random()<.15?(i=!0,r+=e.designerBonus+200,x(!0),setTimeout(()=>x(!1),4e3)):(i=Math.random()<.3,i&&(r+=e.designerBonus));const o=i?"设计师好友":"新好友",m=[...n.helpers,{id:Date.now(),name:o,avatar:"/placeholder.svg",amount:Math.round(r)}];m.length>=5&&b(!0),d(e=>({...e,currentPrice:Math.max(e.bargainPrice,e.currentPrice-r),helpers:m}))},className:"btn btn-secondary flex-1",children:"帮好友砍一刀"})]}),h&&e.jsxs("div",{className:"p-4 bg-blue-50 border-t border-b border-blue-200 text-center",children:[e.jsx("h4",{className:"font-bold text-blue-600",children:"恭喜！"}),e.jsx("p",{className:"text-sm text-blue-500",children:"已获得「服务升级券」：下单即享免费上门测量与设计方案服务。"})]}),e.jsxs("div",{className:"p-4 border-t",children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(r,{size:20})," 助力好友"]}),e.jsx("div",{className:"mt-4 space-y-3",children:n.helpers.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:s.avatar,alt:s.name,className:"w-10 h-10 rounded-full"}),e.jsx("span",{children:s.name})]}),e.jsxs("span",{className:"font-semibold text-green-600",children:["- ¥",s.amount]})]},s.id))})]})]})]})},o=({onClose:s})=>{const a=e=>{navigator.clipboard.writeText(e),alert("已复制到剪贴板！")};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-lg",children:"分享话术模板"}),e.jsx("button",{onClick:s,children:e.jsx(l,{size:24})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"设计师分享："}),e.jsx("p",{className:"text-sm text-gray-600 bg-gray-100 p-2 rounded mt-1",children:"这款沙发我客户很喜欢，我正在砍价，设计师朋友帮忙点一下，你们的一刀比别人管用！"}),e.jsxs("button",{onClick:()=>a("这款沙发我客户很喜欢..."),className:"btn btn-xs btn-secondary mt-1 flex items-center gap-1",children:[e.jsx(n,{size:14})," 复制"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"业主分享："}),e.jsx("p",{className:"text-sm text-gray-600 bg-gray-100 p-2 rounded mt-1",children:"家里装修，看中了这张5000块的床，我一刀砍了350！前5刀最值钱，大家帮帮忙，砍到4000就下单，还送免费上门服务！"}),e.jsxs("button",{onClick:()=>a("家里装修..."),className:"btn btn-xs btn-secondary mt-1 flex items-center gap-1",children:[e.jsx(n,{size:14})," 复制"]})]})]})]})})};export{d as default};
