import{b as e,j as s,v as a}from"./index-DWFic46w.js";import{u as l,r}from"./react-vendor-E1AgTUZ9.js";import{S as n}from"./ShareModal-P_wtyJ-J.js";import{U as t,P as i,H as c,a8 as d,a9 as m,i as o,aa as x,C as h,u as p}from"./ui-vendor-CQy3HONI.js";import{m as j}from"./framer-motion-7DcRqacn.js";import"./recharts-wIacPPq0.js";function u(){const{user:u,logout:g,updateUser:y}=e(),b=l(),[N,f]=r.useState("profile"),[v,k]=r.useState(!1),[w,C]=r.useState(!1),[S,U]=r.useState(!1),[A,z]=r.useState({nickname:"",gender:"",phone:""});r.useEffect(()=>{u&&z({nickname:u.nickname||"",gender:u.gender||"",phone:u.phone||""})},[u]);const O=[{id:"profile",name:"个人信息",icon:t},{id:"orders",name:"我的订单",icon:i},{id:"favorites",name:"我的收藏",icon:c},{id:"settings",name:"账号设置",icon:d},{id:"share",name:"推荐好友",icon:m}];return s.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[s.jsx("div",{className:"container-custom",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[s.jsx("aside",{className:"lg:col-span-1",children:s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"text-center mb-6 pb-6 border-b border-gray-200",children:[s.jsx("div",{className:"w-20 h-20 bg-primary-600 rounded-full flex items-center justify-center text-white text-2xl font-bold mx-auto mb-4",children:((null==u?void 0:u.nickname)||(null==u?void 0:u.phone)||"U").charAt(0).toUpperCase()}),s.jsx("h3",{className:"font-semibold text-lg",children:(null==u?void 0:u.nickname)||(null==u?void 0:u.phone)||"用户"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:null==u?void 0:u.phone})]}),s.jsxs("nav",{className:"space-y-1",children:[O.map(e=>{const a=e.icon;return s.jsxs("button",{onClick:()=>{"share"===e.id?k(!0):f(e.id)},className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors "+(N===e.id?"bg-primary-50 text-primary-600":"text-gray-700 hover:bg-gray-50"),children:[s.jsx(a,{className:"h-5 w-5"}),s.jsx("span",{children:e.name})]},e.id)}),s.jsxs("button",{onClick:()=>{g(),b("/")},className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-red-600 hover:bg-red-50 transition-colors",children:[s.jsx(o,{className:"h-5 w-5"}),s.jsx("span",{children:"退出登录"})]})]})]})}),s.jsx("main",{className:"lg:col-span-3",children:s.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card",children:["profile"===N&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"个人信息"}),w?s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>C(!1),className:"btn-secondary text-sm",children:"取消"}),s.jsxs("button",{onClick:async()=>{if(A.nickname.trim())try{U(!0);const e=await fetch("https://pkochbpmcgaa.sealoshzh.site/api/users/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({nickname:A.nickname.trim(),gender:A.gender,phone:A.phone.trim()})}),s=await e.json();s.success?(y({...u,...A}),p.success("保存成功"),C(!1)):p.error(s.message||"保存失败")}catch(e){p.error("保存失败")}finally{U(!1)}else p.error("请输入姓名")},disabled:S,className:"btn-primary text-sm flex items-center gap-1",children:[s.jsx(x,{className:"w-4 h-4"}),S?"保存中...":"保存"]})]}):s.jsx("button",{onClick:()=>C(!0),className:"btn-secondary text-sm",children:"编辑资料"})]}),w?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"姓名"}),s.jsx("input",{type:"text",value:A.nickname,onChange:e=>z({...A,nickname:e.target.value}),className:"input w-full",placeholder:"请输入您的姓名"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"性别"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("button",{type:"button",onClick:()=>z({...A,gender:"male"}),className:"flex-1 py-2 px-4 rounded-lg border-2 flex items-center justify-center gap-2 transition-all "+("male"===A.gender?"border-primary bg-primary/5 text-primary":"border-gray-200 text-gray-600 hover:border-gray-300"),children:["male"===A.gender&&s.jsx(h,{className:"w-4 h-4"}),"男"]}),s.jsxs("button",{type:"button",onClick:()=>z({...A,gender:"female"}),className:"flex-1 py-2 px-4 rounded-lg border-2 flex items-center justify-center gap-2 transition-all "+("female"===A.gender?"border-primary bg-primary/5 text-primary":"border-gray-200 text-gray-600 hover:border-gray-300"),children:["female"===A.gender&&s.jsx(h,{className:"w-4 h-4"}),"女"]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"手机号"}),s.jsx("input",{type:"tel",value:A.phone,onChange:e=>z({...A,phone:e.target.value}),className:"input w-full",placeholder:"请输入手机号"})]})]}):s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-gray-600",children:"姓名"}),s.jsx("p",{className:"font-medium",children:(null==u?void 0:u.nickname)||"未设置"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-gray-600",children:"性别"}),s.jsx("p",{className:"font-medium",children:"male"===(null==u?void 0:u.gender)?"男":"female"===(null==u?void 0:u.gender)?"女":"未设置"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-gray-600",children:"手机号"}),s.jsx("p",{className:"font-medium",children:(null==u?void 0:u.phone)||"未设置"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-gray-600",children:"角色"}),s.jsx("p",{className:"font-medium",children:"customer"===(null==u?void 0:u.role)?"普通用户":null==u?void 0:u.role})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-gray-600",children:"注册时间"}),s.jsx("p",{className:"font-medium",children:(null==u?void 0:u.createdAt)?a(u.createdAt):"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-gray-600",children:"账户余额"}),s.jsxs("p",{className:"font-medium text-primary-600",children:["¥",(null==u?void 0:u.balance)||0]})]})]})})]}),"orders"===N&&s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-6",children:"我的订单"}),s.jsxs("div",{className:"text-center py-12",children:[s.jsx(i,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"暂无订单"})]})]}),"favorites"===N&&s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-6",children:"我的收藏"}),s.jsxs("div",{className:"text-center py-12",children:[s.jsx(c,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"暂无收藏"})]})]}),"settings"===N&&s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-6",children:"账号设置"}),s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-4",children:"修改密码"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("input",{type:"password",placeholder:"当前密码",className:"input"}),s.jsx("input",{type:"password",placeholder:"新密码",className:"input"}),s.jsx("input",{type:"password",placeholder:"确认新密码",className:"input"}),s.jsx("button",{className:"btn-primary",children:"保存修改"})]})]})})]})]},N)})]})}),s.jsx(n,{isOpen:v,onClose:()=>k(!1)})]})}export{u as default};
