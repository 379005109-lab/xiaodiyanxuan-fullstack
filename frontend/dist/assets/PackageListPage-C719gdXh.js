import{b as e,s,d as a,j as t,f as r}from"./index-DWFic46w.js";import{u as l,r as i,L as n}from"./react-vendor-E1AgTUZ9.js";import{u as c,z as o,ap as d,aM as x,E as m}from"./ui-vendor-CQy3HONI.js";import"./recharts-wIacPPq0.js";const u=()=>{const u=l(),{user:g}=e(),[p,h]=i.useState([]),[j,b]=i.useState(""),[v,f]=i.useState("all");i.useEffect(()=>{y()},[]);const y=async()=>{try{const e=await s.get("/packages",{params:{pageSize:100}});if(!e.data.data||!Array.isArray(e.data.data))return void c.error("å¥—é¤æ•°æ®æ ¼å¼é”™è¯¯");const t=e.data.data.map((e,s)=>{var t;const r=new Set;return e.products&&e.products.length>0&&e.products.forEach(e=>{e.category&&r.add(e.category)}),{id:e._id,name:e.name,price:e.basePrice,productCount:(null==(t=e.products)?void 0:t.length)||0,categoryCount:r.size,image:e.thumbnail?a(e.thumbnail):"/placeholder.svg",status:e.status}});h(t)}catch(e){c.error("åŠ è½½å¥—é¤å¤±è´¥")}},N=p.filter(e=>{const s=e.name.toLowerCase().includes(j.toLowerCase()),a="all"===v||e.status===v;return s&&a});return t.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold",children:"å¥—é¤åˆ—è¡¨"}),t.jsxs(n,{to:"/admin/packages/new",className:"btn-primary",children:[t.jsx(o,{size:20,className:"mr-2"}),"æ–°å»ºå¥—é¤"]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm mb-6 flex items-center gap-4",children:[t.jsx("input",{type:"text",placeholder:"æœç´¢å¥—é¤åç§°...",className:"input w-full max-w-xs",value:j,onChange:e=>b(e.target.value)}),t.jsxs("select",{className:"select",value:v,onChange:e=>f(e.target.value),children:[t.jsx("option",{value:"all",children:"æ‰€æœ‰çŠ¶æ€"}),t.jsx("option",{value:"active",children:"å·²ä¸Šæ¶"}),t.jsx("option",{value:"inactive",children:"å·²ä¸‹æ¶"}),t.jsx("option",{value:"draft",children:"è‰ç¨¿"})]})]}),"all"===v&&N.length>0&&t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:t.jsx("p",{className:"text-sm text-blue-700",children:'ğŸ’¡ ç‚¹å‡»"å·²ä¸Šæ¶"æŒ‰é’®å¯ä»¥ä¸‹æ¶å¥—é¤ï¼Œä¸‹æ¶åçš„å¥—é¤å¯é€šè¿‡ä¸Šæ–¹ç­›é€‰å™¨é€‰æ‹©"å·²ä¸‹æ¶"æŸ¥çœ‹'})}),0===N.length&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx("p",{className:"text-gray-500 mb-2",children:"all"===v?"æš‚æ— å¥—é¤":`æš‚æ— ${"active"===v?"å·²ä¸Šæ¶":"inactive"===v?"å·²ä¸‹æ¶":"è‰ç¨¿"}å¥—é¤`}),"all"!==v&&t.jsx("button",{onClick:()=>f("all"),className:"text-blue-600 hover:text-blue-800 text-sm",children:"æŸ¥çœ‹æ‰€æœ‰å¥—é¤"})]}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:N.map(e=>t.jsxs("div",{className:"bg-white rounded-lg shadow-sm hover:shadow-lg transition-all duration-300 overflow-hidden group",children:[t.jsxs("div",{onClick:()=>{"designer"===(null==g?void 0:g.role)?u(`/admin/packages/designer-edit/${e.id}`):u(`/admin/packages/edit/${e.id}`)},className:"relative aspect-square cursor-pointer overflow-hidden bg-gray-100",children:[t.jsx("img",{src:e.image,alt:e.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),t.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-300 flex items-center justify-center",children:t.jsx(d,{className:"text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300",size:24})}),t.jsx("div",{className:"absolute top-2 right-2",children:t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("active"===e.status?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:"active"===e.status?"å·²ä¸Šæ¶":"å·²ä¸‹æ¶"})})]}),t.jsxs("div",{className:"p-4",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2 line-clamp-1",children:e.name}),t.jsx("p",{className:"text-xl font-bold text-red-500 mb-3",children:r(e.price)}),t.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-4",children:[t.jsxs("span",{children:["ğŸ“¦ ",e.productCount,"ä»¶"]}),t.jsxs("span",{children:["ğŸ·ï¸ ",e.categoryCount,"ç±»"]})]}),t.jsx("div",{className:"flex flex-col gap-2",children:t.jsxs("div",{className:"flex gap-2",children:["designer"!==(null==g?void 0:g.role)&&t.jsxs("button",{onClick:s=>{s.stopPropagation(),u(`/admin/packages/profit/${e.id}`)},className:"flex-1 flex items-center justify-center gap-1 px-2 py-2 rounded-lg bg-blue-100 text-blue-700 hover:bg-blue-200 transition-colors",title:"åˆ©æ¶¦ç®¡ç†",children:[t.jsx(x,{size:16}),t.jsx("span",{className:"text-xs font-medium",children:"åˆ©æ¶¦"})]}),t.jsxs("button",{onClick:s=>{s.stopPropagation(),"designer"===(null==g?void 0:g.role)?u(`/admin/packages/designer-edit/${e.id}`):u(`/admin/packages/edit/${e.id}`)},className:"flex-1 flex items-center justify-center gap-1 px-2 py-2 rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors",title:"ç¼–è¾‘å¥—é¤",children:[t.jsx(d,{size:16}),t.jsx("span",{className:"text-xs font-medium",children:"ç¼–è¾‘"})]}),"designer"!==(null==g?void 0:g.role)&&t.jsxs("button",{onClick:a=>{a.stopPropagation(),window.confirm(`ç¡®å®šè¦åˆ é™¤"${e.name}"å—ï¼Ÿ`)&&(async e=>{try{await s.delete(`/packages/${e}`),c.success("å¥—é¤å·²åˆ é™¤"),y()}catch(a){c.error("åˆ é™¤å¥—é¤å¤±è´¥")}})(e.id)},className:"flex-1 flex items-center justify-center gap-1 px-2 py-2 rounded-lg bg-red-100 text-red-700 hover:bg-red-200 transition-colors",title:"åˆ é™¤å¥—é¤",children:[t.jsx(m,{size:16}),t.jsx("span",{className:"text-xs font-medium",children:"åˆ é™¤"})]})]})})]})]},e.id))})]})};export{u as default};
