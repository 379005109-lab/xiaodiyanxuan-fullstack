import{_ as e,$ as s,a0 as t,a1 as a,j as r,a2 as l,a3 as n,a4 as d,a5 as c,a6 as x,a7 as o}from"./index-DWFic46w.js";import{r as i}from"./react-vendor-E1AgTUZ9.js";import{S as m,an as g,am as h,E as p,D as u,al as b,aw as j,x as y,u as N}from"./ui-vendor-CQy3HONI.js";import"./recharts-wIacPPq0.js";function f(){const[f,w]=i.useState([]),[v,S]=i.useState(""),[C,k]=i.useState("all"),[z,$]=i.useState("time"),[A,D]=i.useState(new Set),[E,J]=i.useState(null),[O,V]=i.useState(!1);i.useEffect(()=>{F()},[v,C,z]);const F=()=>{let r=e();v&&(r=s(v)),"all"!==C&&(r=r.filter(e=>e.type===C)),r=t(z),w(r),J(a())},L=e=>({order:"订单",system:"系统",message:"消息"}[e]||e);return r.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[r.jsx("h1",{className:"text-3xl font-bold mb-6",children:"通知管理"}),E&&r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"总通知数"}),r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:E.total})]}),r.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"未读通知"}),r.jsx("p",{className:"text-2xl font-bold text-red-600",children:E.unread})]}),r.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"已读通知"}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:E.read})]}),r.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"重要通知"}),r.jsx("p",{className:"text-2xl font-bold text-orange-600",children:l().length})]})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 mb-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx(m,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"搜索通知...",value:v,onChange:e=>S(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),r.jsxs("select",{value:C,onChange:e=>k(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",children:[r.jsx("option",{value:"all",children:"所有类型"}),r.jsx("option",{value:"order",children:"订单通知"}),r.jsx("option",{value:"system",children:"系统通知"}),r.jsx("option",{value:"message",children:"消息通知"})]}),r.jsxs("select",{value:z,onChange:e=>$(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",children:[r.jsx("option",{value:"time",children:"按时间排序"}),r.jsx("option",{value:"type",children:"按类型排序"}),r.jsx("option",{value:"read",children:"按已读排序"})]})]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[A.size>0&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>{const e=n(Array.from(A),"read");N.success(`已标记 ${e} 条通知为已读`),F(),D(new Set)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm flex items-center gap-2",children:[r.jsx(g,{className:"h-4 w-4"}),"标记已读 (",A.size,")"]}),r.jsxs("button",{onClick:()=>{const e=n(Array.from(A),"unread");N.success(`已标记 ${e} 条通知为未读`),F(),D(new Set)},className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 text-sm flex items-center gap-2",children:[r.jsx(h,{className:"h-4 w-4"}),"标记未读 (",A.size,")"]}),r.jsxs("button",{onClick:()=>{if(confirm(`确定要删除 ${A.size} 条通知吗？`)){const e=n(Array.from(A),"delete");N.success(`已删除 ${e} 条通知`),F(),D(new Set)}},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm flex items-center gap-2",children:[r.jsx(p,{className:"h-4 w-4"}),"删除 (",A.size,")"]})]}),r.jsxs("button",{onClick:()=>{d("json"),N.success("已导出为 JSON 文件")},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm flex items-center gap-2",children:[r.jsx(u,{className:"h-4 w-4"}),"导出 JSON"]}),r.jsxs("button",{onClick:()=>{d("csv"),N.success("已导出为 CSV 文件")},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm flex items-center gap-2",children:[r.jsx(u,{className:"h-4 w-4"}),"导出 CSV"]}),r.jsxs("button",{onClick:()=>{if(confirm("确定要删除7天前的通知吗？")){const e=c(7);N.success(`已删除 ${e} 条旧通知`),F()}},className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 text-sm flex items-center gap-2",children:[r.jsx(p,{className:"h-4 w-4"}),"清理旧通知"]}),r.jsxs("button",{onClick:()=>{x(),N.success("报告已输出到控制台")},className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-sm flex items-center gap-2",children:[r.jsx(b,{className:"h-4 w-4"}),"生成报告"]}),r.jsxs("button",{onClick:()=>{o(),N.success("摘要已输出到控制台")},className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 text-sm flex items-center gap-2",children:[r.jsx(j,{className:"h-4 w-4"}),"显示摘要"]})]})]}),r.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left",children:r.jsx("input",{type:"checkbox",checked:A.size===f.length&&f.length>0,onChange:()=>{A.size===f.length?D(new Set):D(new Set(f.map(e=>e.id)))},className:"rounded"})}),r.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:"标题"}),r.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:"类型"}),r.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:"内容"}),r.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:"状态"}),r.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:"时间"})]})}),r.jsx("tbody",{children:f.length>0?f.map(e=>{return r.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-3",children:r.jsx("input",{type:"checkbox",checked:A.has(e.id),onChange:()=>(e=>{const s=new Set(A);s.has(e)?s.delete(e):s.add(e),D(s)})(e.id),className:"rounded"})}),r.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:e.title}),r.jsx("td",{className:"px-4 py-3",children:r.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${s=e.type,{order:"bg-blue-100 text-blue-700",system:"bg-yellow-100 text-yellow-700",message:"bg-green-100 text-green-700"}[s]||"bg-gray-100 text-gray-700"}`,children:L(e.type)})}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 max-w-xs truncate",children:e.message}),r.jsx("td",{className:"px-4 py-3",children:r.jsx("span",{className:"px-2 py-1 rounded text-xs font-semibold "+(e.read?"bg-gray-100 text-gray-700":"bg-blue-100 text-blue-700"),children:e.read?"已读":"未读"})}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(e.createdAt).toLocaleString("zh-CN")})]},e.id);var s}):r.jsx("tr",{children:r.jsxs("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:[r.jsx(y,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),r.jsx("p",{children:"没有找到匹配的通知"})]})})})]})}),r.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:["显示 ",f.length," 条通知"]})]})}export{f as default};
