import{s as e,j as s}from"./index-DWFic46w.js";import{r as a}from"./react-vendor-E1AgTUZ9.js";import{u as t,P as r,U as l,m as c,ad as i,aO as d,O as n,aK as m,a4 as x,b as o}from"./ui-vendor-CQy3HONI.js";import"./recharts-wIacPPq0.js";function g(){const[g,h]=a.useState([]),[u,p]=a.useState(!0),[j,b]=a.useState("");a.useEffect(()=>{N()},[j]);const N=async()=>{var s,a,r;try{p(!0);const a={};j&&(a.status=j);const t=await e.get("/buying-service-requests",{params:a}),r=(null==(s=t.data)?void 0:s.data)||t.data,l=Array.isArray(r)?r:[];h(l)}catch(l){(null==(r=null==(a=l.response)?void 0:a.data)?void 0:r.message)?t.error("加载失败："+l.response.data.message):t.error("加载失败")}finally{p(!1)}},y=async(s,a)=>{try{await e.put(`/buying-service-requests/${s}/status`,{status:a}),t.success("状态更新成功"),N()}catch(r){t.error("更新失败")}},v=e=>"standard"===e?"¥1,000":"¥5,000";return u?s.jsx("div",{className:"p-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"加载中..."})]})})}):s.jsxs("div",{className:"p-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(r,{className:"w-8 h-8 text-primary"}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"陪买服务需求"})]}),s.jsx("p",{className:"text-gray-600",children:"管理用户的陪买服务预约请求"})]}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"状态筛选："}),s.jsx("div",{className:"flex gap-2",children:[{value:"",label:"全部"},{value:"pending",label:"待确认"},{value:"confirmed",label:"已确认"},{value:"completed",label:"已完成"},{value:"cancelled",label:"已取消"}].map(e=>s.jsx("button",{onClick:()=>b(e.value),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors "+(j===e.value?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:e.label},e.value))})]})}),0===g.length?s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[s.jsx(r,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 text-lg font-medium mb-2",children:"暂无陪买服务请求"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"用户预约后将在此显示"})]}):s.jsx("div",{className:"space-y-4",children:g.map(e=>{const a=(e=>{const a={pending:{label:"待确认",color:"bg-orange-100 text-orange-800",icon:s.jsx(o,{className:"w-4 h-4"})},confirmed:{label:"已确认",color:"bg-blue-100 text-blue-800",icon:s.jsx(x,{className:"w-4 h-4"})},completed:{label:"已完成",color:"bg-green-100 text-green-800",icon:s.jsx(x,{className:"w-4 h-4"})},cancelled:{label:"已取消",color:"bg-red-100 text-red-800",icon:s.jsx(m,{className:"w-4 h-4"})}};return a[e]||a.pending})(e.status);return s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium ${a.color}`,children:[a.icon,a.label]}),s.jsxs("div",{className:"px-3 py-1 bg-primary/10 text-primary rounded-full text-sm font-medium",children:[(t=e.serviceType,"standard"===t?"基础陪买服务":"专家定制陪买")," - ",v(e.serviceType)]})]}),s.jsx("div",{className:"text-sm text-gray-500",children:new Date(e.createdAt).toLocaleString("zh-CN")})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(l,{className:"w-5 h-5 text-gray-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"客户姓名"}),s.jsx("p",{className:"font-medium text-gray-900",children:e.user.name})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(c,{className:"w-5 h-5 text-gray-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"联系电话"}),s.jsx("p",{className:"font-medium text-gray-900",children:e.user.phone})]})]}),e.user.email&&s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(i,{className:"w-5 h-5 text-gray-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"电子邮箱"}),s.jsx("p",{className:"font-medium text-gray-900",children:e.user.email})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(d,{className:"w-5 h-5 text-gray-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"预约时间"}),s.jsx("p",{className:"font-medium text-gray-900",children:new Date(e.createdAt).toLocaleDateString("zh-CN")})]})]})]}),e.notes&&s.jsxs("div",{className:"flex items-start gap-3 mb-4 p-4 bg-gray-50 rounded-lg",children:[s.jsx(n,{className:"w-5 h-5 text-gray-400 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"备注信息"}),s.jsx("p",{className:"text-gray-700",children:e.notes})]})]}),s.jsxs("div",{className:"flex gap-2 pt-4 border-t border-gray-200",children:["pending"===e.status&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>y(e._id,"confirmed"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:"确认预约"}),s.jsx("button",{onClick:()=>y(e._id,"cancelled"),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"取消预约"})]}),"confirmed"===e.status&&s.jsx("button",{onClick:()=>y(e._id,"completed"),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium",children:"标记完成"})]})]},e._id);var t})})]})}export{g as default};
