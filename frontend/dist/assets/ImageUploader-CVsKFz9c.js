import{j as e,d as r,y as a}from"./index-DWFic46w.js";import{r as t}from"./react-vendor-E1AgTUZ9.js";import{aD as s,as as o,aq as n,X as l,u as i}from"./ui-vendor-CQy3HONI.js";function c({images:c,onChange:d,multiple:m=!1,maxImages:p=10,label:u="ä¸Šä¼ å›¾ç‰‡"}){const[f,g]=t.useState(!1),[x,h]=t.useState(!1),v=t.useRef(null),y=async e=>{!m&&e.length>1&&(e=[e[0]]),h(!0);try{for(const t of e)if(t.type.startsWith("image/"))try{const e=await a(t);if(e.success){const r=e.data.fileId;m?c.length<p&&d([...c,r]):d([r]),i.success(`${t.name} ä¸Šä¼ æˆåŠŸ`)}}catch(r){i.error(`${t.name} ä¸Šä¼ å¤±è´¥`)}}finally{h(!1),v.current&&(v.current.value="")}},b=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{onClick:x?void 0:()=>{var e;null==(e=v.current)||e.click()},onDragOver:x?void 0:e=>{e.preventDefault(),g(!0)},onDragLeave:x?void 0:e=>{e.preventDefault(),g(!1)},onDrop:x?void 0:e=>{e.preventDefault(),g(!1);const r=Array.from(e.dataTransfer.files);y(r)},className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors "+(x?"border-gray-300 bg-gray-50 cursor-not-allowed":f?"border-primary-500 bg-primary-50 cursor-pointer":"border-gray-300 hover:border-primary-400 cursor-pointer"),children:[x?e.jsx(s,{className:"h-12 w-12 text-primary-500 mx-auto mb-4 animate-spin"}):e.jsx(o,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-2",children:x?"ä¸Šä¼ ä¸­...":u}),e.jsx("p",{className:"text-gray-400 text-sm",children:x?"è¯·ç­‰å¾…ä¸Šä¼ å®Œæˆ":"ç‚¹å‡»ä¸Šä¼ æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„"+(m?` (æœ€å¤š${p}å¼ )`:"")}),e.jsx("input",{ref:v,type:"file",accept:"image/*",multiple:m,onChange:e=>{const r=Array.from(e.target.files||[]);y(r)},disabled:x,className:"hidden"})]}),c.length>0&&e.jsx("div",{className:"flex flex-wrap gap-4",children:c.map((a,t)=>e.jsxs("div",{draggable:!0,onDragStart:e=>((e,r)=>{e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",r.toString())})(e,t),onDragOver:b,onDrop:e=>((e,r)=>{e.preventDefault();const a=parseInt(e.dataTransfer.getData("text/plain"));if(a===r)return;const t=Array.from(c),[s]=t.splice(a,1);t.splice(r,0,s),d(t)})(e,t),className:"relative group cursor-move",children:[e.jsx("div",{className:"w-32 h-32 border-2 border-gray-200 rounded-lg overflow-hidden hover:border-primary-500 transition-colors",children:e.jsx("img",{src:r(a),alt:`é¢„è§ˆ ${t+1}`,className:"w-full h-full object-cover"})}),e.jsx("div",{className:"absolute top-2 left-2 p-1 bg-white rounded shadow-md cursor-move opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(n,{className:"h-4 w-4 text-gray-600"})}),e.jsx("button",{onClick:()=>(e=>{const r=c.filter((r,a)=>a!==e);d(r)})(t),className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full shadow-md opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",children:e.jsx(l,{className:"h-4 w-4"})}),0===t&&m&&e.jsx("div",{className:"absolute bottom-2 left-2 px-2 py-1 bg-primary-600 text-white text-xs rounded",children:"ä¸»å›¾"})]},a+t))}),c.length>0&&m&&e.jsx("p",{className:"text-sm text-gray-500",children:"ğŸ’¡ æç¤ºï¼šé•¿æŒ‰æ‹–åŠ¨å›¾ç‰‡å¯æ”¹å˜é¡ºåºï¼Œç¬¬ä¸€å¼ ä¸ºä¸»å›¾"})]})}export{c as I};
