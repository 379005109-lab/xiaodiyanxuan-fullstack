import{j as e,f as s,o as a}from"./index-DWFic46w.js";import{i as t,d as r,r as i,L as n}from"./react-vendor-E1AgTUZ9.js";import{a as l}from"./axios-DX3AsQR4.js";import{d as c}from"./ui-vendor-CQy3HONI.js";import"./recharts-wIacPPq0.js";function d(){const{id:d}=t(),[m]=r(),[o,h]=i.useState(null),[x,g]=i.useState(!0),[u,p]=i.useState(null),j=m.get("version")||"standard",f=m.get("spec")||"",N=m.get("fabric")||"",v=m.get("filling")||"",y=m.get("frame")||"",b=m.get("leg")||"",[w,P]=i.useState([]);if(i.useEffect(()=>{(async()=>{try{const e=await a();P(Array.isArray(e)?e:[])}catch(e){P([])}})()},[]),i.useEffect(()=>{(async()=>{var e,s;if(d)try{g(!0),p(null);const e=await l.get(`/products/${d}`),s=null==e?void 0:e.data;s?h(s):p("商品不存在")}catch(a){p((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.message)||"加载商品失败，请稍后重试")}finally{g(!1)}else g(!1)})()},[d]),x)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:"加载中..."})]})});if(u||!o)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:u||"商品不存在"}),e.jsx(n,{to:"/",className:"text-blue-600 hover:underline",children:"返回首页"})]})});const I=(()=>{const e=[];o.images&&o.images.length>0&&e.push(...o.images);const s=o;s.whiteBackgroundImages&&e.push(...s.whiteBackgroundImages),s.effectImages&&e.push(...s.effectImages),s.componentImages&&e.push(...s.componentImages),s.detailImages&&e.push(...s.detailImages),s.otherImages&&e.push(...s.otherImages);const a=o.skus.find(e=>{const s=e.isPro===("pro"===j),a=(e.spec||e.code)===f;if(!s||!a)return!1;const t=e.material;if("string"==typeof t)return!N||t===N;if(t&&"object"==typeof t){const e=t,s=!N||e.fabric===N,a=!v||e.filling===v,r=!y||e.frame===y,i=!b||e.leg===b;return s&&a&&r&&i}return!0});return a&&a.images&&a.images.length>0&&e.push(...a.images),[...new Set(e)]})(),k=e=>{const s=w.find(s=>s.name===e);return(null==s?void 0:s.name)||e},S=o.skus.find(e=>{const s=e.isPro===("pro"===j),a=(e.spec||e.code)===f;if(!s||!a)return!1;const t=e.material;if("string"==typeof t)return!N||t===N;if(t&&"object"==typeof t){const e=t,s=!N||e.fabric===N,a=!v||e.filling===v,r=!y||e.frame===y,i=!b||e.leg===b;return s&&a&&r&&i}return!0})||o.skus[0],$=(null==S?void 0:S.discountPrice)&&S.discountPrice>0&&S.discountPrice<S.price?S.discountPrice:(null==S?void 0:S.price)||o.basePrice;return e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm mb-4",children:[e.jsx(n,{to:"/",className:"text-gray-600 hover:text-blue-600",children:"首页"}),e.jsx(c,{className:"h-4 w-4 text-gray-400"}),e.jsx(n,{to:"/products",className:"text-gray-600 hover:text-blue-600",children:"商城"}),e.jsx(c,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-900 font-medium",children:o.name})]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:o.name}),o.description&&e.jsx("p",{className:"text-gray-600 mt-2",children:o.description})]}),I.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"商品图片"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:I.map((s,a)=>e.jsx("div",{className:"aspect-square rounded-lg overflow-hidden bg-gray-100",children:e.jsx("img",{src:s,alt:`${o.name} - 图片 ${a+1}`,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none"}})},a))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"商品信息"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"版本："}),e.jsx("span",{className:"font-medium",children:"pro"===j?"PRO版":"标准版"})]}),(f||S)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"规格："}),e.jsx("span",{className:"font-medium",children:f||(null==S?void 0:S.spec)||(null==S?void 0:S.code)||"默认规格"}),S&&e.jsx(e.Fragment,{children:S.length&&S.width&&S.height&&e.jsxs("span",{className:"text-gray-500 ml-2",children:["(",S.length," × ",S.width," × ",S.height," cm)"]})})]}),(N||v||y||b)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"材质："}),e.jsxs("div",{className:"mt-2 space-y-2",children:[N&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"面料："}),e.jsx("span",{className:"font-medium",children:k(N)})]}),v&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"填充："}),e.jsx("span",{className:"font-medium",children:k(v)})]}),y&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"框架："}),e.jsx("span",{className:"font-medium",children:k(y)})]}),b&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"脚架："}),e.jsx("span",{className:"font-medium",children:k(b)})]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"价格："}),e.jsx("span",{className:"text-2xl font-bold text-red-600 ml-2",children:s($)}),(null==S?void 0:S.discountPrice)&&S.discountPrice>0&&S.discountPrice<S.price&&e.jsx("span",{className:"text-gray-400 line-through ml-2",children:s(S.price)})]}),(null==S?void 0:S.isPro)&&S.proFeature&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"PRO特性："}),e.jsx("span",{className:"font-medium",children:S.proFeature})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsx(n,{to:`/products/${d}`,className:"w-full btn-primary py-3 text-center block",children:"查看完整详情"})})]})})}export{d as default};
