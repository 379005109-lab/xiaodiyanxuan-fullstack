import{s as e,j as t,f as s,v as a}from"./index-DWFic46w.js";import{r as l}from"./react-vendor-E1AgTUZ9.js";import{u as r,P as d,aM as o,b as n,T as i,al as c}from"./ui-vendor-CQy3HONI.js";import{m as x}from"./framer-motion-7DcRqacn.js";import"./recharts-wIacPPq0.js";function m(){const[m,g]=l.useState({totalOrders:0,totalRevenue:0,pendingOrders:0,completedOrders:0,avgOrderValue:0,todayOrders:0,todayRevenue:0,weekOrders:0,weekRevenue:0,monthOrders:0,monthRevenue:0,statusBreakdown:{pending:0,paid:0,shipped:0,completed:0,cancelled:0,refunding:0,refunded:0}}),[b,p]=l.useState([]),[y,h]=l.useState([]),[u,j]=l.useState(!0);l.useEffect(()=>{N()},[]);const N=async()=>{j(!0);try{const t=await e.get("/orders/stats");if(t.data.success){const e=t.data.data;g({totalOrders:e.totalOrders||0,totalRevenue:e.totalRevenue||0,pendingOrders:e.pendingOrders||0,completedOrders:e.completedOrders||0,avgOrderValue:e.avgOrderValue||0,todayOrders:e.todayOrders||0,todayRevenue:e.todayRevenue||0,weekOrders:e.weekOrders||0,weekRevenue:e.weekRevenue||0,monthOrders:e.monthOrders||0,monthRevenue:e.monthRevenue||0,statusBreakdown:e.statusBreakdown||{}}),p(e.recentOrders||[]),h(e.dailyTrend||[])}}catch(t){r.error("加载数据失败")}finally{j(!1)}},f={1:{label:"待付款",color:"text-yellow-700",bgColor:"bg-yellow-100"},2:{label:"待发货",color:"text-green-700",bgColor:"bg-green-100"},3:{label:"待收货",color:"text-blue-700",bgColor:"bg-blue-100"},4:{label:"已完成",color:"text-gray-700",bgColor:"bg-gray-100"},5:{label:"已取消",color:"text-red-700",bgColor:"bg-red-100"},6:{label:"退款中",color:"text-orange-700",bgColor:"bg-orange-100"},7:{label:"已退款",color:"text-purple-700",bgColor:"bg-purple-100"},8:{label:"换货中",color:"text-amber-700",bgColor:"bg-amber-100"},pending:{label:"待付款",color:"text-yellow-700",bgColor:"bg-yellow-100"},processing:{label:"处理中",color:"text-amber-700",bgColor:"bg-amber-100"},paid:{label:"已付款",color:"text-green-700",bgColor:"bg-green-100"},shipped:{label:"已发货",color:"text-blue-700",bgColor:"bg-blue-100"},completed:{label:"已完成",color:"text-gray-700",bgColor:"bg-gray-100"},cancelled:{label:"已取消",color:"text-red-700",bgColor:"bg-red-100"},refunding:{label:"退款中",color:"text-orange-700",bgColor:"bg-orange-100"},refunded:{label:"已退款",color:"text-purple-700",bgColor:"bg-purple-100"}};return u?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):t.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"订单数据看板"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"实时订单统计和分析"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"card bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"总订单数"}),t.jsx("p",{className:"text-3xl font-bold text-blue-600",children:m.totalOrders})]}),t.jsx(d,{className:"h-12 w-12 text-blue-300 opacity-50"})]})}),t.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"card bg-gradient-to-br from-green-50 to-green-100 border border-green-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"总收入"}),t.jsx("p",{className:"text-3xl font-bold text-green-600",children:s(m.totalRevenue)})]}),t.jsx(o,{className:"h-12 w-12 text-green-300 opacity-50"})]})}),t.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"card bg-gradient-to-br from-yellow-50 to-yellow-100 border border-yellow-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"待处理订单"}),t.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:m.pendingOrders})]}),t.jsx(n,{className:"h-12 w-12 text-yellow-300 opacity-50"})]})}),t.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"card bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"平均订单金额"}),t.jsx("p",{className:"text-3xl font-bold text-purple-600",children:s(m.avgOrderValue)})]}),t.jsx(i,{className:"h-12 w-12 text-purple-300 opacity-50"})]})})]}),t.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"card",children:[t.jsxs("h2",{className:"text-xl font-semibold mb-6 flex items-center gap-2",children:[t.jsx(c,{className:"h-5 w-5"}),"订单状态分布"]}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4",children:Object.entries(m.statusBreakdown).map(([e,s])=>{const a=f[e]||{label:e,color:"text-gray-700",bgColor:"bg-gray-100"};return t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:`${a.bgColor} ${a.color} rounded-lg p-4 mb-2`,children:t.jsx("p",{className:"text-2xl font-bold",children:s})}),t.jsx("p",{className:"text-xs text-gray-600",children:a.label})]},e)})})]}),t.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"card",children:[t.jsx("h2",{className:"text-xl font-semibold mb-6",children:"最近7天订单趋势"}),t.jsx("div",{className:"space-y-4",children:y.length>0?y.map((e,a)=>{const l=Math.max(...y.map(e=>e.orders),1),r=Math.max(...y.map(e=>e.revenue),1),d=e.orders/l*100,o=e.revenue/r*100;return t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between items-center text-sm",children:[t.jsx("span",{className:"font-medium text-gray-700",children:e.date}),t.jsxs("span",{className:"text-gray-600",children:[e.orders," 订单 · ",s(e.revenue)]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("div",{className:"flex-1",children:t.jsx("div",{className:"bg-blue-100 rounded-full h-2 overflow-hidden",children:t.jsx("div",{className:"bg-blue-500 h-full transition-all",style:{width:`${d}%`}})})}),t.jsx("div",{className:"flex-1",children:t.jsx("div",{className:"bg-green-100 rounded-full h-2 overflow-hidden",children:t.jsx("div",{className:"bg-green-500 h-full transition-all",style:{width:`${o}%`}})})})]})]},a)}):t.jsx("p",{className:"text-gray-500 text-center py-8",children:"暂无数据"})})]}),t.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},className:"card",children:[t.jsx("h2",{className:"text-xl font-semibold mb-6",children:"最近订单"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[t.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"订单号"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"客户"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"金额"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"商品数"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"状态"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"时间"})]})}),t.jsx("tbody",{children:b.length>0?b.map(e=>{var l,r;const d=f[e.status]||{label:String(e.status),color:"text-gray-700",bgColor:"bg-gray-100"},o="string"==typeof e.user?e.user:(null==(l=e.user)?void 0:l.name)||"未知客户";return t.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4",children:t.jsx("span",{className:"font-medium text-gray-900",children:e.orderNo})}),t.jsx("td",{className:"py-3 px-4",children:t.jsx("span",{className:"text-gray-700",children:o})}),t.jsx("td",{className:"py-3 px-4",children:t.jsx("span",{className:"font-semibold text-primary-600",children:s(e.totalAmount)})}),t.jsx("td",{className:"py-3 px-4",children:t.jsx("span",{className:"text-gray-700",children:(null==(r=e.items)?void 0:r.length)||0})}),t.jsx("td",{className:"py-3 px-4",children:t.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${d.bgColor} ${d.color}`,children:d.label})}),t.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:a(e.createdAt)})]},e._id)}):t.jsx("tr",{children:t.jsx("td",{colSpan:6,className:"py-8 text-center text-gray-500",children:"暂无订单数据"})})})]})})]})]})}export{m as default};
