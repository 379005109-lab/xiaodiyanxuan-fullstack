import{j as e,f as s,d as t}from"./index-DWFic46w.js";import{u as a,r as l}from"./react-vendor-E1AgTUZ9.js";import{u as r,J as n,a2 as i,at as o,B as c,E as d,U as x,an as m,am as p,X as g,C as h,a1 as u,x as b,O as y,au as f,P as j,F as N,z as v,b as w,a0 as k,av as C,S,D as $,ab as z}from"./ui-vendor-CQy3HONI.js";import{u as A,w as P}from"./xlsx-DSA9T5jJ.js";import{h as _}from"./html2canvas-CeZt5dlh.js";import"./recharts-wIacPPq0.js";const T={1:{label:"å¾…ä»˜æ¬¾",color:"text-orange-600",bgColor:"bg-orange-100"},pending:{label:"å¾…ä»˜æ¬¾",color:"text-orange-600",bgColor:"bg-orange-100"},2:{label:"å·²ä»˜æ¬¾",color:"text-blue-600",bgColor:"bg-blue-100"},paid:{label:"å·²ä»˜æ¬¾",color:"text-blue-600",bgColor:"bg-blue-100"},3:{label:"å¾…å‘è´§",color:"text-purple-600",bgColor:"bg-purple-100"},processing:{label:"å¤„ç†ä¸­",color:"text-purple-600",bgColor:"bg-purple-100"},4:{label:"å·²å‘è´§",color:"text-green-600",bgColor:"bg-green-100"},shipped:{label:"å·²å‘è´§",color:"text-green-600",bgColor:"bg-green-100"},5:{label:"å·²å®Œæˆ",color:"text-gray-600",bgColor:"bg-gray-100"},completed:{label:"å·²å®Œæˆ",color:"text-gray-600",bgColor:"bg-gray-100"},6:{label:"é€€æ¬¾ä¸­",color:"text-yellow-600",bgColor:"bg-yellow-100"},refunding:{label:"é€€æ¬¾ä¸­",color:"text-yellow-600",bgColor:"bg-yellow-100"},7:{label:"å·²é€€æ¬¾",color:"text-red-600",bgColor:"bg-red-100"},refunded:{label:"å·²é€€æ¬¾",color:"text-red-600",bgColor:"bg-red-100"},8:{label:"å·²å–æ¶ˆ",color:"text-gray-500",bgColor:"bg-gray-100"},cancelled:{label:"å·²å–æ¶ˆ",color:"text-gray-500",bgColor:"bg-gray-100"}},D=e=>e?e.length>15?e.slice(0,15)+"******":e:"";function M(){const M=a(),[I,L]=l.useState([]),[U,E]=l.useState(!0),[B,O]=l.useState("all"),[q,H]=l.useState(""),[J,R]=l.useState(""),[F,K]=l.useState(null),[G,Q]=l.useState(!1),[V,W]=l.useState(!1),[X,Y]=l.useState(!1),[Z,ee]=l.useState(""),[se,te]=l.useState(!1),[ae,le]=l.useState({company:"",trackingNo:""}),[re,ne]=l.useState(!1),[ie,oe]=l.useState(""),[ce,de]=l.useState(!1),[xe,me]=l.useState(""),[pe,ge]=l.useState(!1),[he,ue]=l.useState(""),[be,ye]=l.useState([]),[fe,je]=l.useState(!0),[Ne,ve]=l.useState({all:0,pending:0,shipping:0,afterSale:0});l.useEffect(()=>{we()},[]);const we=async()=>{try{E(!0);const e=localStorage.getItem("token");if(!e)return r.error("è¯·å…ˆç™»å½•"),void M("/");const s=await fetch("https://pkochbpmcgaa.sealoshzh.site/api/orders?pageSize=100",{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("åŠ è½½å¤±è´¥");const t=(await s.json()).data||[];t.sort((e,s)=>new Date(s.createdAt).getTime()-new Date(e.createdAt).getTime()),L(t),ve({all:t.length,pending:t.filter(e=>1===e.status||"pending"===e.status).length,shipping:t.filter(e=>2===e.status||3===e.status||"paid"===e.status||"processing"===e.status).length,afterSale:t.filter(e=>6===e.status||7===e.status||"refunding"===e.status||"refunded"===e.status||e.refundStatus).length})}catch(e){r.error("åŠ è½½è®¢å•å¤±è´¥")}finally{E(!1)}},ke=I.filter(e=>{var s,t;const a=e.recipient||e.shippingAddress;if(q){const l=q.toLowerCase(),r=null==(s=e.orderNo)?void 0:s.toLowerCase().includes(l),n=null==(t=null==a?void 0:a.name)?void 0:t.toLowerCase().includes(l);if(!r&&!n)return!1}switch(B){case"pending":return 1===e.status||"pending"===e.status;case"shipping":return 2===e.status||3===e.status||"paid"===e.status||"processing"===e.status;case"afterSale":return 6===e.status||7===e.status||"refunding"===e.status||"refunded"===e.status||e.refundStatus;default:return!0}}),Ce=I.find(e=>e._id===F),Se=e=>{var s;if("package"===e.orderType&&e.packageInfo){const t=[];return null==(s=e.packageInfo.selections)||s.forEach(e=>{var s;null==(s=e.products)||s.forEach(s=>{const a=s.selectedMaterials||s.materials||{},l=s.materialUpgradePrices||{};t.push({name:s.productName,quantity:s.quantity,skuName:s.skuName,materials:a,selectedMaterials:{fabric:a.fabric||a["é¢æ–™"]||"",filling:a.filling||a["å¡«å……"]||"",frame:a.frame||a["æ¡†æ¶"]||"",leg:a.leg||a["è„šæ¶"]||""},materialUpgradePrices:{fabric:l.fabric||l["é¢æ–™"]||0,filling:l.filling||l["å¡«å……"]||0,frame:l.frame||l["æ¡†æ¶"]||0,leg:l.leg||l["è„šæ¶"]||0},upgradePrice:s.upgradePrice||s.materialUpgrade||0,image:s.image,category:e.categoryName})})}),t}return e.items?e.items.map(e=>({name:e.productName,quantity:e.quantity,materials:e.materials,specifications:e.specifications,selectedMaterials:e.selectedMaterials,materialUpgradePrices:e.materialUpgradePrices,image:e.image||e.productImage})):[]},$e=(e,s,t)=>{const a={id:Date.now().toString(),orderId:e,type:s,content:t,operator:"admin",createdAt:(new Date).toISOString()};ye(e=>[a,...e])},ze=async()=>{if(!Ce)return void r.error("è¯·å…ˆé€‰æ‹©ä¸€ä¸ªè®¢å•");const e=Se(Ce);if(0===e.length)return void r.error("è¯¥è®¢å•æ²¡æœ‰å•†å“");Ce.recipient||Ce.shippingAddress;const s=T[Ce.status]||T[1],a=document.createElement("div");a.style.cssText="position: absolute; left: -9999px; top: 0; width: 800px; background: white; padding: 40px; font-family: system-ui, -apple-system, sans-serif;",a.innerHTML=`\n      <div style="border: 2px solid #e5e7eb; border-radius: 12px; overflow: hidden;">\n        \x3c!-- è®¢å•å¤´éƒ¨ --\x3e\n        <div style="background: linear-gradient(135deg, #3b82f6, #1d4ed8); color: white; padding: 24px;">\n          <h1 style="margin: 0 0 8px 0; font-size: 24px; font-weight: bold;">è®¢å•å•†å“æ¸…å•</h1>\n          <p style="margin: 0; opacity: 0.9;">è®¢å•å·ï¼š${Ce.orderNo}</p>\n          <p style="margin: 4px 0 0 0; opacity: 0.9;">ä¸‹å•æ—¶é—´ï¼š${new Date(Ce.createdAt).toLocaleString("zh-CN")}</p>\n        </div>\n        \n        \x3c!-- å•†å“æ¸…å• --\x3e\n        <div style="padding: 20px;">\n          <h3 style="margin: 0 0 16px 0; font-size: 16px; color: #374151;">ğŸ“¦ å•†å“æ¸…å•</h3>\n          <table style="width: 100%; border-collapse: collapse; font-size: 14px;">\n            <thead>\n              <tr style="background: #f3f4f6;">\n                <th style="padding: 12px; text-align: left; border: 1px solid #e5e7eb;">å•†å“å›¾ç‰‡</th>\n                <th style="padding: 12px; text-align: left; border: 1px solid #e5e7eb;">å•†å“åç§°</th>\n                <th style="padding: 12px; text-align: left; border: 1px solid #e5e7eb;">è§„æ ¼/æè´¨</th>\n                <th style="padding: 12px; text-align: center; border: 1px solid #e5e7eb;">æ•°é‡</th>\n              </tr>\n            </thead>\n            <tbody>\n              ${e.map(e=>{const s=e.specifications||e.specs||{},a=Object.entries(s).map(([e,s])=>`<div style="margin-bottom: 4px;"><span style="color: #6b7280;">${{size:"å°ºå¯¸",spec:"è§„æ ¼",material:"æè´¨",fabric:"é¢æ–™",filling:"å¡«å……",fill:"å¡«å……",frame:"æ¡†æ¶",color:"é¢œè‰²",style:"é£æ ¼",leg:"è„šæ¶",legs:"è„šæ¶",armrest:"æ‰¶æ‰‹",cushion:"åå«",back:"é èƒŒ",width:"å®½åº¦",height:"é«˜åº¦",depth:"æ·±åº¦",length:"é•¿åº¦",seat:"åº§ä½",base:"åº•åº§",cover:"å¥—é¢",inner:"å†…èƒ†",support:"æ”¯æ’‘",spring:"å¼¹ç°§",foam:"æµ·ç»µ",wood:"æœ¨æ",metal:"é‡‘å±"}[e.toLowerCase()]||e}ï¼š</span>${s}</div>`),l=a.length>0?a.join(""):e.spec?`<div>${e.spec}</div>`:"<div>-</div>";return`\n                  <tr>\n                    <td style="padding: 12px; border: 1px solid #e5e7eb; vertical-align: middle;">\n                      ${e.image?`<img src="${t(e.image)}" style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;" crossorigin="anonymous" />`:'<div style="width: 80px; height: 80px; background: #e5e7eb; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #9ca3af;">æ— å›¾</div>'}\n                    </td>\n                    <td style="padding: 12px; border: 1px solid #e5e7eb; vertical-align: middle;">\n                      <div style="font-weight: 600; color: #1f2937;">${e.name||"æœªçŸ¥å•†å“"}</div>\n                    </td>\n                    <td style="padding: 12px; border: 1px solid #e5e7eb; vertical-align: top; color: #4b5563; font-size: 13px;">\n                      ${l}\n                    </td>\n                    <td style="padding: 12px; border: 1px solid #e5e7eb; text-align: center; font-weight: 600; color: #1f2937; vertical-align: middle;">\n                      Ã—${e.quantity||1}\n                    </td>\n                  </tr>\n                `}).join("")}\n            </tbody>\n          </table>\n        </div>\n        \n        \x3c!-- è®¢å•çŠ¶æ€ --\x3e\n        <div style="padding: 20px; background: #f9fafb; border-top: 1px solid #e5e7eb;">\n          <div style="display: flex; justify-content: space-between; align-items: center;">\n            <span style="font-size: 16px; color: #374151;">è®¢å•çŠ¶æ€ï¼š<span style="color: #3b82f6; font-weight: 600;">${s.label}</span></span>\n            <span style="font-size: 14px; color: #6b7280;">å…± ${e.length} ä»¶å•†å“</span>\n          </div>\n          ${Ce.adminNote?`<p style="margin: 12px 0 0 0; color: #6b7280; font-size: 14px;">å•†å®¶å¤‡æ³¨ï¼š${Ce.adminNote}</p>`:""}\n        </div>\n      </div>\n      <p style="text-align: center; color: #9ca3af; font-size: 12px; margin-top: 16px;">ç”Ÿæˆæ—¶é—´ï¼š${(new Date).toLocaleString("zh-CN")}</p>\n    `,document.body.appendChild(a);try{r.loading("æ­£åœ¨ç”Ÿæˆè®¢å•å›¾ç‰‡...");const e=a.querySelectorAll("img");await Promise.all(Array.from(e).map(e=>new Promise(s=>{e.complete?s(!0):(e.onload=()=>s(!0),e.onerror=()=>s(!0))})));const s=await _(a,{backgroundColor:"#ffffff",scale:2,useCORS:!0,allowTaint:!0,logging:!1}),t=document.createElement("a");t.download=`è®¢å•æ¸…å•_${Ce.orderNo}.png`,t.href=s.toDataURL("image/png"),t.click(),r.dismiss(),r.success("è®¢å•æ¸…å•å›¾ç‰‡å·²å¯¼å‡º")}catch(l){r.dismiss(),r.error("ç”Ÿæˆå›¾ç‰‡å¤±è´¥")}finally{document.body.removeChild(a)}};if(Ce){const a=T[Ce.status]||T[1],l=Ce.recipient||Ce.shippingAddress||{name:"",phone:"",address:""},S=Ce.shippingAddress,$=l.address||(S?[S.province,S.city,S.district,S.detail].filter(Boolean).join(""):""),z=Se(Ce);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white px-6 py-4 border-b",children:e.jsxs("button",{onClick:()=>K(null),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900",children:[e.jsx(n,{className:"w-4 h-4"}),"è¿”å›è®¢å•åˆ—è¡¨"]})}),e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm "+(6===Ce.status||"cancelled"===Ce.status?"opacity-60":""),children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`w-3 h-3 rounded-full ${a.bgColor}`}),e.jsx("h1",{className:"text-2xl font-bold "+(6===Ce.status||"cancelled"===Ce.status?"line-through text-gray-400":""),children:a.label}),e.jsx("button",{onClick:()=>W(!V),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded",title:"ç¼–è¾‘çŠ¶æ€",children:e.jsx(i,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-gray-400 text-sm",children:["è®¢å•å·: ",Ce.orderNo]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[(1===Ce.status||"pending"===Ce.status)&&e.jsx("button",{onClick:()=>Y(!0),className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors text-sm",children:"æ ‡è®°å·²ä»˜"}),(2===Ce.status||3===Ce.status||"paid"===Ce.status||"processing"===Ce.status)&&e.jsx("button",{onClick:()=>te(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"å‘è´§"}),(4===Ce.status||"shipped"===Ce.status)&&e.jsx("button",{onClick:()=>(async e=>{try{const s=localStorage.getItem("token");(await fetch(`https://pkochbpmcgaa.sealoshzh.site/api/orders/${e}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({status:5})})).ok?(r.success("è®¢å•å·²å®Œæˆ"),$e(e,"complete","è®¢å•å·²å®Œæˆ"),we()):r.error("æ“ä½œå¤±è´¥")}catch(s){r.error("æ“ä½œå¤±è´¥")}})(Ce._id),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm",children:"å®Œæˆè®¢å•"}),6!==Ce.status&&"cancelled"!==Ce.status&&5!==Ce.status&&"completed"!==Ce.status&&e.jsxs("button",{onClick:()=>ne(!0),className:"px-4 py-2 border border-gray-300 text-gray-600 rounded-lg hover:bg-gray-50 transition-colors text-sm flex items-center gap-1",children:[e.jsx(o,{className:"w-4 h-4"}),"å–æ¶ˆ"]}),e.jsxs("button",{onClick:ze,className:"px-4 py-2 border border-gray-300 text-gray-600 rounded-lg hover:bg-gray-50 transition-colors text-sm flex items-center gap-1",children:[e.jsx(c,{className:"w-4 h-4"}),"å¯¼å‡ºæ¸…å•å›¾ç‰‡"]}),e.jsxs("button",{onClick:()=>(async e=>{try{const s=localStorage.getItem("token");(await fetch(`https://pkochbpmcgaa.sealoshzh.site/api/orders/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).ok?(r.success("è®¢å•å·²ç§»è‡³å›æ”¶ç«™"),K(null),we()):r.error("åˆ é™¤å¤±è´¥")}catch(s){r.error("åˆ é™¤å¤±è´¥")}})(Ce._id),className:"px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50 transition-colors text-sm flex items-center gap-1",children:[e.jsx(d,{className:"w-4 h-4"}),"åˆ é™¤"]})]})]}),V&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"é€‰æ‹©æ–°çŠ¶æ€ï¼š"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:1,label:"å¾…ä»˜æ¬¾"},{value:2,label:"å·²ä»˜æ¬¾"},{value:3,label:"å¾…å‘è´§"},{value:4,label:"å·²å‘è´§"},{value:5,label:"å·²å®Œæˆ"},{value:6,label:"å·²å–æ¶ˆ"}].map(s=>e.jsx("button",{onClick:()=>(async(e,s)=>{try{const t=localStorage.getItem("token");(await fetch(`https://pkochbpmcgaa.sealoshzh.site/api/orders/${e}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({status:s})})).ok?(r.success("çŠ¶æ€å·²æ›´æ–°"),W(!1),we()):r.error("æ“ä½œå¤±è´¥")}catch(t){r.error("æ“ä½œå¤±è´¥")}})(Ce._id,s.value),className:"px-3 py-1.5 text-sm rounded-lg border transition-colors "+(Ce.status===s.value?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:border-blue-500"),children:s.label},s.value))})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-5 h-5 text-gray-500"}),e.jsx("h2",{className:"font-semibold",children:"å®¢æˆ·ä¿¡æ¯"}),e.jsx("span",{className:"text-xs text-gray-400",children:G?"(å·²è§£å¯†)":"(å·²åŠ å¯†)"})]}),e.jsxs("button",{onClick:()=>G?void Q(!1):(async e=>{$e(e,"view_sensitive","æŸ¥çœ‹äº†å®¢æˆ·æ•æ„Ÿä¿¡æ¯"),Q(!0)})(Ce._id),className:"p-2 rounded-lg transition-colors flex items-center gap-1.5 "+(G?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-500 hover:bg-gray-200"),title:G?"ç‚¹å‡»éšè—":"ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ä¿¡æ¯",children:[G?e.jsx(m,{className:"w-5 h-5"}):e.jsx(p,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:G?"éšè—":"æŸ¥çœ‹"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"è”ç³»äºº"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-medium",children:l.name||"æœªå¡«å†™"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"è”ç³»ç”µè¯"}),e.jsx("span",{className:"font-medium",children:G?l.phone:l.phone?(Ae=l.phone,!Ae||Ae.length<7?Ae:Ae.slice(0,3)+"****"+Ae.slice(-4)):"æœªå¡«å†™"})]}),e.jsxs("div",{className:"col-span-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"æ”¶è´§åœ°å€"}),e.jsx("span",{className:"font-medium",children:G?$:$?D($):"æœªå¡«å†™"})]})]})]}),X&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"é€‰æ‹©æ”¯ä»˜æ¸ é“"}),e.jsx("button",{onClick:()=>Y(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(g,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"space-y-3",children:[{value:"wechat",label:"å¾®ä¿¡æ”¯ä»˜",icon:"ğŸ’š"},{value:"alipay",label:"æ”¯ä»˜å®",icon:"ğŸ’™"},{value:"bank",label:"å¯¹å…¬è´¦æˆ·",icon:"ğŸ¦"}].map(s=>e.jsxs("button",{onClick:()=>ee(s.value),className:"w-full p-4 rounded-xl border-2 flex items-center gap-3 transition-colors "+(Z===s.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[e.jsx("span",{className:"text-2xl",children:s.icon}),e.jsx("span",{className:"font-medium",children:s.label}),Z===s.value&&e.jsx(h,{className:"w-5 h-5 text-blue-600 ml-auto"})]},s.value))}),e.jsxs("div",{className:"mt-6 flex gap-3",children:[e.jsx("button",{onClick:()=>Y(!1),className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:()=>Z&&(async(e,s)=>{try{const t=localStorage.getItem("token");if((await fetch(`https://pkochbpmcgaa.sealoshzh.site/api/orders/${e}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({status:2,paymentMethod:s})})).ok){const t={wechat:"å¾®ä¿¡",alipay:"æ”¯ä»˜å®",bank:"å¯¹å…¬è´¦æˆ·"};r.success("å·²æ ‡è®°ä¸ºå·²ä»˜æ¬¾"),Y(!1),ee(""),$e(e,"payment",`è®¢å•å·²ä»˜æ¬¾ï¼Œæ”¯ä»˜æ¸ é“ï¼š${t[s]||s}`),we()}else r.error("æ“ä½œå¤±è´¥")}catch(t){r.error("æ“ä½œå¤±è´¥")}})(Ce._id,Z),disabled:!Z,className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"ç¡®è®¤ä»˜æ¬¾"})]})]})}),se&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5 text-blue-600"}),"å¡«å†™ç‰©æµä¿¡æ¯"]}),e.jsx("button",{onClick:()=>te(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(g,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1.5",children:"ç‰©æµå…¬å¸"}),e.jsxs("select",{value:ae.company,onChange:e=>le(s=>({...s,company:e.target.value})),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"è¯·é€‰æ‹©ç‰©æµå…¬å¸"}),e.jsx("option",{value:"é¡ºä¸°é€Ÿè¿",children:"é¡ºä¸°é€Ÿè¿"}),e.jsx("option",{value:"äº¬ä¸œç‰©æµ",children:"äº¬ä¸œç‰©æµ"}),e.jsx("option",{value:"åœ†é€šé€Ÿé€’",children:"åœ†é€šé€Ÿé€’"}),e.jsx("option",{value:"ä¸­é€šå¿«é€’",children:"ä¸­é€šå¿«é€’"}),e.jsx("option",{value:"éŸµè¾¾å¿«é€’",children:"éŸµè¾¾å¿«é€’"}),e.jsx("option",{value:"ç”³é€šå¿«é€’",children:"ç”³é€šå¿«é€’"}),e.jsx("option",{value:"å¾·é‚¦ç‰©æµ",children:"å¾·é‚¦ç‰©æµ"}),e.jsx("option",{value:"å…¶ä»–",children:"å…¶ä»–"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1.5",children:"å¿«é€’å•å·"}),e.jsx("input",{type:"text",value:ae.trackingNo,onChange:e=>le(s=>({...s,trackingNo:e.target.value})),placeholder:"è¯·è¾“å…¥å¿«é€’å•å·",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"mt-6 flex gap-3",children:[e.jsx("button",{onClick:()=>te(!1),className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:()=>(async e=>{if(ae.company&&ae.trackingNo)try{const s=localStorage.getItem("token");(await fetch(`https://pkochbpmcgaa.sealoshzh.site/api/orders/${e}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({status:4,shippingCompany:ae.company,trackingNumber:ae.trackingNo})})).ok?(r.success("è®¢å•å·²å‘è´§"),te(!1),le({company:"",trackingNo:""}),$e(e,"ship",`è®¢å•å·²å‘è´§ï¼Œ${ae.company}ï¼š${ae.trackingNo}`),we()):r.error("æ“ä½œå¤±è´¥")}catch(s){r.error("æ“ä½œå¤±è´¥")}else r.error("è¯·å¡«å†™å®Œæ•´çš„ç‰©æµä¿¡æ¯")})(Ce._id),className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"ç¡®è®¤å‘è´§"})]})]})}),re&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(b,{className:"w-5 h-5 text-orange-500"}),"å–æ¶ˆè®¢å•"]}),e.jsx("button",{onClick:()=>ne(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(g,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"ç¡®å®šè¦å–æ¶ˆæ­¤è®¢å•å—ï¼Ÿå–æ¶ˆåè®¢å•å°†æ˜¾ç¤ºä¸ºç°è‰²åˆ’çº¿çŠ¶æ€ã€‚"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1.5",children:"å–æ¶ˆåŸå› ï¼ˆå¯é€‰ï¼‰"}),e.jsx("textarea",{value:ie,onChange:e=>oe(e.target.value),placeholder:"è¯·è¾“å…¥å–æ¶ˆåŸå› ...",rows:3,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>ne(!1),className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"è¿”å›"}),e.jsx("button",{onClick:()=>(async(e,s)=>{try{const t=localStorage.getItem("token");(await fetch(`https://pkochbpmcgaa.sealoshzh.site/api/orders/${e}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({status:6,cancelReason:s})})).ok?(r.success("è®¢å•å·²å–æ¶ˆ"),ne(!1),oe(""),$e(e,"cancel",`è®¢å•å·²å–æ¶ˆï¼ŒåŸå› ï¼š${s||"æœªå¡«å†™"}`),we()):r.error("æ“ä½œå¤±è´¥")}catch(t){r.error("æ“ä½œå¤±è´¥")}})(Ce._id,ie),className:"flex-1 px-4 py-2.5 bg-orange-500 text-white rounded-lg hover:bg-orange-600",children:"ç¡®è®¤å–æ¶ˆ"})]})]})}),pe&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5 text-blue-600"}),"æ·»åŠ è·Ÿè¿›è®°å½•"]}),e.jsx("button",{onClick:()=>ge(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(g,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"mb-4",children:e.jsx("textarea",{value:he,onChange:e=>ue(e.target.value),placeholder:"è¯·è¾“å…¥è·Ÿè¿›å†…å®¹...",rows:4,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>ge(!1),className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:()=>(async(e,s)=>{s.trim()?($e(e,"followup",s),r.success("è·Ÿè¿›è®°å½•å·²æ·»åŠ "),ge(!1),ue("")):r.error("è¯·è¾“å…¥è·Ÿè¿›å†…å®¹")})(Ce._id,he),className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"ä¿å­˜"})]})]})}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{className:"w-5 h-5 text-gray-500"}),e.jsx("h2",{className:"font-semibold",children:"å•†å®¶å¤‡æ³¨"})]}),e.jsxs("button",{onClick:()=>{me(Ce.adminNote||""),de(!ce)},className:"text-blue-600 text-sm hover:text-blue-700 flex items-center gap-1",children:[e.jsx(i,{className:"w-4 h-4"}),ce?"å–æ¶ˆ":"ç¼–è¾‘"]})]}),ce?e.jsxs("div",{className:"space-y-3",children:[e.jsx("textarea",{value:xe,onChange:e=>me(e.target.value),placeholder:"æ·»åŠ å•†å®¶å¤‡æ³¨ï¼Œå¦‚ï¼šå®¢æˆ·è¦æ±‚åŠ æ€¥å¤„ç†...",rows:3,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{onClick:()=>de(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 text-sm",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:()=>(async(e,s)=>{try{const t=localStorage.getItem("token");(await fetch(`https://pkochbpmcgaa.sealoshzh.site/api/orders/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({adminNote:s})})).ok?(r.success("å¤‡æ³¨å·²ä¿å­˜"),de(!1),$e(e,"remark",`æ›´æ–°å•†å®¶å¤‡æ³¨ï¼š${s}`),we()):r.error("ä¿å­˜å¤±è´¥")}catch(t){r.error("ä¿å­˜å¤±è´¥")}})(Ce._id,xe),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:"ä¿å­˜å¤‡æ³¨"})]})]}):e.jsx("div",{className:"flex flex-wrap gap-2",children:Ce.adminNote?e.jsx("span",{className:"px-3 py-1.5 bg-blue-50 text-blue-700 rounded-full text-sm",children:Ce.adminNote}):e.jsx("span",{className:"text-gray-400 text-sm",children:"æš‚æ— å¤‡æ³¨ï¼Œç‚¹å‡»ç¼–è¾‘æ·»åŠ "})})]}),Ce.notes&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4",children:[e.jsx("span",{className:"text-amber-700 font-medium",children:"ä¹°å®¶å¤‡æ³¨"}),e.jsx("span",{className:"text-red-500 ml-3",children:Ce.notes})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 px-6 py-4 border-b border-gray-100",children:[e.jsx(j,{className:"w-5 h-5 text-gray-400"}),e.jsx("h2",{className:"font-medium text-gray-700",children:"å•†å“æ¸…å•"})]}),"package"===Ce.orderType&&Ce.packageInfo&&e.jsxs("div",{className:"mx-6 mt-4 px-3 py-2 bg-amber-50 rounded-lg",children:[e.jsxs("div",{className:"text-sm font-medium text-amber-800",children:["ğŸ“¦ å¥—é¤ï¼š",Ce.packageInfo.packageName]}),e.jsxs("div",{className:"text-xs text-amber-600 mt-1",children:["å¥—é¤ä»·ï¼šÂ¥",s(Ce.packageInfo.packagePrice)]})]}),e.jsx("div",{className:"divide-y divide-gray-100",children:z.map((s,a)=>{var l,r,n,i,o,c,d,x,m,p,g,h,u,b,y,f,N,v,w,k,C,S;const $=[];((null==(l=s.selectedMaterials)?void 0:l.fabric)||(null==(r=s.specifications)?void 0:r.material))&&$.push((null==(n=s.selectedMaterials)?void 0:n.fabric)||(null==(i=s.specifications)?void 0:i.material)),((null==(o=s.selectedMaterials)?void 0:o.filling)||(null==(c=s.specifications)?void 0:c.fill))&&$.push((null==(d=s.selectedMaterials)?void 0:d.filling)||(null==(x=s.specifications)?void 0:x.fill)),((null==(m=s.selectedMaterials)?void 0:m.frame)||(null==(p=s.specifications)?void 0:p.frame))&&$.push((null==(g=s.selectedMaterials)?void 0:g.frame)||(null==(h=s.specifications)?void 0:h.frame)),((null==(u=s.selectedMaterials)?void 0:u.leg)||(null==(b=s.specifications)?void 0:b.leg))&&$.push((null==(y=s.selectedMaterials)?void 0:y.leg)||(null==(f=s.specifications)?void 0:f.leg));const z=[];return(null==(N=s.materialUpgradePrices)?void 0:N.fabric)>0&&z.push({name:"é¢æ–™",price:s.materialUpgradePrices.fabric}),(null==(v=s.materialUpgradePrices)?void 0:v.filling)>0&&z.push({name:"å¡«å……",price:s.materialUpgradePrices.filling}),(null==(w=s.materialUpgradePrices)?void 0:w.frame)>0&&z.push({name:"æ¡†æ¶",price:s.materialUpgradePrices.frame}),(null==(k=s.materialUpgradePrices)?void 0:k.leg)>0&&z.push({name:"è„šæ¶",price:s.materialUpgradePrices.leg}),e.jsxs("div",{className:"flex items-start gap-4 px-6 py-5",children:[e.jsx("div",{className:"w-20 h-20 rounded-lg overflow-hidden bg-gray-100 flex-shrink-0",children:s.image?e.jsx("img",{src:t(s.image),alt:s.name,className:"w-full h-full object-cover",onError:e=>{e.target.src="/placeholder.svg"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-300",children:e.jsx(j,{className:"w-8 h-8"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-blue-600",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[s.skuName||"æ ‡å‡†æ¬¾"," / ",(null==(C=s.specifications)?void 0:C.color)||"é»˜è®¤"]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[(null==(S=s.specifications)?void 0:S.size)&&e.jsx("span",{className:"px-2.5 py-1 text-xs text-gray-600 bg-gray-50 border border-gray-200 rounded-md",children:s.specifications.size}),$.map((s,t)=>e.jsx("span",{className:"px-2.5 py-1 text-xs text-gray-600 bg-gray-50 border border-gray-200 rounded-md",children:s},t))]}),(z.length>0||s.upgradePrice>0)&&e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[z.map((s,t)=>e.jsxs("span",{className:"text-xs text-red-600",children:[s.name," +Â¥",s.price]},t)),s.upgradePrice>0&&0===z.length&&e.jsxs("span",{className:"text-xs text-red-600",children:["åŠ ä»· +Â¥",s.upgradePrice]})]})]}),e.jsxs("div",{className:"text-gray-400 text-sm flex-shrink-0",children:["x",s.quantity]})]},a)})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-100 bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-gray-500",children:"å•†å“å°è®¡"}),e.jsxs("span",{className:"text-gray-800",children:["Â¥",s(Ce.subtotal||Ce.totalAmount)]})]}),Ce.discountAmount&&Ce.discountAmount>0&&e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-gray-500",children:"ä¼˜æƒ "}),e.jsxs("span",{className:"text-red-500",children:["-Â¥",s(Ce.discountAmount)]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-200",children:[e.jsx("span",{className:"text-gray-800 font-medium",children:"è®¢å•æ€»é¢"}),e.jsxs("span",{className:"text-red-600 text-2xl font-bold",children:["Â¥",s(Ce.totalAmount)]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5 text-gray-500"}),e.jsx("h2",{className:"font-semibold",children:"è®¢å•åŠ¨æ€"})]}),e.jsxs("button",{onClick:()=>ge(!0),className:"text-blue-600 text-sm hover:text-blue-700 flex items-center gap-1",children:[e.jsx(v,{className:"w-4 h-4"}),"æ·»åŠ è·Ÿè¿›"]})]}),e.jsxs("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:[e.jsxs("div",{className:"text-sm text-gray-500 flex items-start gap-2 pb-3 border-b border-gray-100",children:[e.jsx(w,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-xs",children:new Date(Ce.createdAt).toLocaleString("zh-CN")}),e.jsx("p",{className:"text-gray-600",children:"è®¢å•åˆ›å»º"})]})]}),Ce.paidAt&&e.jsxs("div",{className:"text-sm text-gray-500 flex items-start gap-2 pb-3 border-b border-gray-100",children:[e.jsx(k,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-xs",children:new Date(Ce.paidAt).toLocaleString("zh-CN")}),e.jsxs("p",{className:"text-gray-600",children:["è®¢å•å·²ä»˜æ¬¾ ",Ce.paymentMethod&&`ï¼ˆ${"wechat"===Ce.paymentMethod?"å¾®ä¿¡":"alipay"===Ce.paymentMethod?"æ”¯ä»˜å®":"å¯¹å…¬è´¦æˆ·"}ï¼‰`]})]})]}),Ce.shippedAt&&e.jsxs("div",{className:"text-sm text-gray-500 flex items-start gap-2 pb-3 border-b border-gray-100",children:[e.jsx(u,{className:"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-xs",children:new Date(Ce.shippedAt).toLocaleString("zh-CN")}),e.jsxs("p",{className:"text-gray-600",children:["è®¢å•å·²å‘è´§ ",Ce.trackingNumber&&`ï¼ˆ${Ce.trackingNumber}ï¼‰`]})]})]}),Ce.completedAt&&e.jsxs("div",{className:"text-sm text-gray-500 flex items-start gap-2 pb-3 border-b border-gray-100",children:[e.jsx(k,{className:"w-4 h-4 text-gray-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-xs",children:new Date(Ce.completedAt).toLocaleString("zh-CN")}),e.jsx("p",{className:"text-gray-600",children:"è®¢å•å·²å®Œæˆ"})]})]}),be.filter(e=>e.orderId===Ce._id).filter(e=>!("view_sensitive"===e.type&&!fe)).map(s=>e.jsxs("div",{className:"text-sm flex items-start gap-2 pb-3 border-b border-gray-100",children:["followup"===s.type&&e.jsx(y,{className:"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0"}),"remark"===s.type&&e.jsx(f,{className:"w-4 h-4 text-purple-500 mt-0.5 flex-shrink-0"}),"cancel"===s.type&&e.jsx(o,{className:"w-4 h-4 text-orange-500 mt-0.5 flex-shrink-0"}),"payment"===s.type&&e.jsx(C,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),"ship"===s.type&&e.jsx(u,{className:"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0"}),"complete"===s.type&&e.jsx(k,{className:"w-4 h-4 text-gray-500 mt-0.5 flex-shrink-0"}),"view_sensitive"===s.type&&e.jsx(m,{className:"w-4 h-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-xs",children:new Date(s.createdAt).toLocaleString("zh-CN")}),e.jsx("p",{className:""+("view_sensitive"===s.type?"text-red-600":"text-gray-600"),children:s.content}),e.jsxs("span",{className:"text-xs text-gray-400",children:["æ“ä½œäºº: ",s.operator]})]})]},s.id))]})]})]})]})}var Ae;return e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>O("all"),className:"flex-1 p-4 rounded-xl border-2 transition-all "+("all"===B?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"),children:[e.jsx("p",{className:"text-sm text-gray-500",children:"å…¨éƒ¨"}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:Ne.all})]}),e.jsxs("button",{onClick:()=>O("pending"),className:"flex-1 p-4 rounded-xl border-2 transition-all "+("pending"===B?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"),children:[e.jsx("p",{className:"text-sm text-gray-500",children:"å¾…ä»˜æ¬¾"}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:Ne.pending})]}),e.jsxs("button",{onClick:()=>O("shipping"),className:"flex-1 p-4 rounded-xl border-2 transition-all "+("shipping"===B?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"),children:[e.jsx("p",{className:"text-sm text-gray-500",children:"å¾…å‘è´§"}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:Ne.shipping})]}),e.jsxs("button",{onClick:()=>O("afterSale"),className:"flex-1 p-4 rounded-xl border-2 transition-all "+("afterSale"===B?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"),children:[e.jsx("p",{className:"text-sm text-gray-500",children:"å”®å"}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:Ne.afterSale})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:J,onChange:e=>R(e.target.value),className:"px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"æ”¯ä»˜æ–¹å¼"}),e.jsx("option",{value:"wechat",children:"å¾®ä¿¡æ”¯ä»˜"}),e.jsx("option",{value:"alipay",children:"æ”¯ä»˜å®"}),e.jsx("option",{value:"bank",children:"é“¶è¡Œè½¬è´¦"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"æœç´¢è®¢å•...",value:q,onChange:e=>H(e.target.value),className:"pl-10 pr-4 py-2.5 w-64 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500"})]})]}),e.jsxs("button",{onClick:()=>{if(0===ke.length)return void r.error("æ²¡æœ‰å¯å¯¼å‡ºçš„è®¢å•");const e=ke.map(e=>{const s=Se(e),t=T[e.status]||T[1];return{"è®¢å•å·":e.orderNo,"åˆ›å»ºæ—¶é—´":new Date(e.createdAt).toLocaleString("zh-CN"),"å•†å“ä¿¡æ¯":s.map(e=>`${e.name}x${e.quantity}`).join("; "),"è®¢å•çŠ¶æ€":t.label,"å•†å®¶å¤‡æ³¨":e.adminNote||"","ç‰©æµå…¬å¸":e.shippingCompany||"","ç‰©æµå•å·":e.trackingNumber||""}}),s=A.json_to_sheet(e),t=A.book_new();A.book_append_sheet(t,s,"è®¢å•åˆ—è¡¨"),s["!cols"]=[{wch:20},{wch:20},{wch:40},{wch:10},{wch:30},{wch:15},{wch:20}],P(t,`è®¢å•å¯¼å‡º_${(new Date).toLocaleDateString("zh-CN")}.xlsx`),r.success(`å·²å¯¼å‡º ${ke.length} æ¡è®¢å•`)},className:"flex items-center gap-2 px-4 py-2.5 border border-gray-200 rounded-xl hover:bg-gray-50",children:[e.jsx($,{className:"w-4 h-4"}),"å¯¼å‡ºè¡¨æ ¼"]})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-gray-500",children:"è®¢å•ä¿¡æ¯"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-gray-500",children:"ä¹°å®¶"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-gray-500",children:"å•†å®¶å¤‡æ³¨ (REMARKS)"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-gray-500",children:"é‡‘é¢"}),e.jsx("th",{className:"text-left px-6 py-4 text-sm font-medium text-gray-500",children:"çŠ¶æ€"}),e.jsx("th",{className:"text-right px-6 py-4 text-sm font-medium text-gray-500",children:"æ“ä½œ"})]})}),e.jsx("tbody",{className:"divide-y",children:U?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-20 text-center text-gray-500",children:"åŠ è½½ä¸­..."})}):0===ke.length?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-20 text-center text-gray-500",children:"æš‚æ— è®¢å•æ•°æ®"})}):ke.map(t=>{var a;const l=T[t.status]||T[1],n=t.recipient||t.shippingAddress,i=(null==n?void 0:n.name)||"æœªçŸ¥",o=i.charAt(0);return e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>K(t._id),children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:e=>{e.stopPropagation(),K(t._id)},className:"font-medium text-blue-600 hover:text-blue-700 hover:underline",children:t.orderNo}),e.jsx("button",{onClick:e=>{e.stopPropagation();const a=t.recipient||t.shippingAddress,l=(null==a?void 0:a.address)||[null==a?void 0:a.province,null==a?void 0:a.city,null==a?void 0:a.district,null==a?void 0:a.detail].filter(Boolean).join(""),n=(t.items||t.products||[]).map(e=>`${e.name||e.productName} x${e.quantity||1}`).join("\n"),i=`è®¢å•å·ï¼š${t.orderNo}\næ”¶ä»¶äººï¼š${(null==a?void 0:a.name)||""}\nç”µè¯ï¼š${(null==a?void 0:a.phone)||""}\nåœ°å€ï¼š${l}\nå•†å“ï¼š\n${n}\næ€»é‡‘é¢ï¼šÂ¥${s(t.totalAmount)}`;navigator.clipboard.writeText(i),r.success("è®¢å•ä¿¡æ¯å·²å¤åˆ¶")},className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded",title:"å¤åˆ¶è®¢å•ä¿¡æ¯",children:e.jsx(z,{className:"w-3.5 h-3.5"})})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[new Date(t.createdAt).toLocaleDateString("zh-CN")," Â· å…± ",(null==(a=t.items)?void 0:a.length)||0," ä»¶"]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center text-sm font-medium",children:o}),e.jsx("span",{className:"font-medium",children:i})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"text-gray-600 truncate max-w-[200px]",children:t.notes||"æ·»åŠ å¤‡æ³¨..."})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"font-bold text-red-600",children:["Â¥",s(t.totalAmount)]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-sm ${l.bgColor} ${l.color}`,children:l.label})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:e=>{e.stopPropagation(),K(t._id)},className:"text-blue-600 hover:text-blue-700 hover:underline",children:"è¯¦æƒ…"})})]},t._id)})})]})})]})}export{M as default};
